var Zef=window.Zef||{};Zef.FlexCandidateResultCardVisual=function(){this.containerClassName="selectedItemContainer";this.useContainerClassName=!1};Zef.FlexCandidateResultCardVisual.prototype=new Zef.Visual;Zef.FlexCandidateResultCardVisual.prototype.getValueForSubcomponent=function(){return""};Zef.FlexCandidateResultCardVisual.prototype.getStyle=function(a,b){var d=a.indexOf(b);if(0<=d){var c=a.indexOf(";",d+b.length);0>c&&(c=a.length-1);return a.substring(d+b.length+1,c)}return""};
Zef.FlexCandidateResultCardVisual.prototype.getHTMLTemplate=function(){var a=Zef.Visual.prototype.getHTMLTemplate.call(this);if("undefined"!=typeof this.component.properties&&null!=this.component.properties&&"undefined"!=typeof this.component.properties.comps){var a=zefJQuery(a),b=zefJQuery(a).closest(".zg_resultcard");b.length?a=b[0]:(b=zefJQuery(a).find(".container"),b.length?a=b[0]:(b=zefJQuery(a).find("div"),b.length&&(a=b[0])));b="";this.extraEvents={};for(var d=0;d<this.component.properties.comps.length;d++){var c=
this.component.properties.comps[d],e='<div class="zg_resultcardItem zg_resultcardItem_'+d+'" id="zg_resultcardItem_'+c.name.replace(RegExp(" ","g"),"_")+'" style="{zg_'+c.name.replace(RegExp(" ","g"),"_")+'/display: none;}">';c.showName&&"LABEL"!=c.type&&(e=e+'<span class="zg_resultcardItemTitle">'+c.name+"</span>");if("NAME"==c.type)e+=" {name}";else if("EMAIL"==c.type)e+=" {email}";else if("PARTY"==c.type)e+=' <span class="zg_resultcardParty">{folder}</span>';else if("IMAGE"==c.type){e=e+' <img src="{'+
c.name+'}" ';c="zg_"+c.name.replace(RegExp(" ","g"),"_");if("undefined"!==typeof this.settings&&"undefined"!==typeof this.settings.subComponentStyles){for(var f=-1,g=0;g<this.settings.subComponentStyleNames.length;g++)if(this.settings.subComponentStyleNames[g]==c){f=g;break}if(0<=f&&(c=this.settings.subComponentStyles[f])&&"_"!=c)f=this.getStyle(c,"width"),0<f.indexOf("px")&&(f=f.substring(0,f.indexOf("px"))),null!=f&&(""!=f&&"null"!=f)&&(e=e+'width="'+f+'" '),f=this.getStyle(c,"height"),0<f.indexOf("px")&&
(f=f.substring(0,f.indexOf("px"))),null!=f&&(""!=f&&"null"!=f)&&(e=e+'height="'+f+'" ')}e+="></img>"}else if("TARGET_IMAGE"==c.type){e+='<img src="{targetImage}" ';c="zg_"+c.name.replace(RegExp(" ","g"),"_");if("undefined"!==typeof this.settings&&"undefined"!==typeof this.settings.subComponentStyles){f=-1;for(g=0;g<this.settings.subComponentStyleNames.length;g++)if(this.settings.subComponentStyleNames[g]==c){f=g;break}if(0<=f&&(c=this.settings.subComponentStyles[f])&&"_"!=c)f=this.getStyle(c,"width"),
0<f.indexOf("px")&&(f=f.substring(0,f.indexOf("px"))),null!=f&&(""!=f&&"null"!=f)&&(e=e+'width="'+f+'" '),f=this.getStyle(c,"height"),0<f.indexOf("px")&&(f=f.substring(0,f.indexOf("px"))),null!=f&&(""!=f&&"null"!=f)&&(e=e+'height="'+f+'" ')}e+="></img>"}else if("LABEL"==c.type)e=e+'<span class="zg_resultcardItemLabel">'+c.name+"</span";else if("TEXT"==c.type)!1==c.showName&&(e=e+'<span class="zg_resultcardItemTitle">'+c.name+"</span>"),e=e+' <input id="'+this.component.id+"_"+c.name+'" type="text" value="{'+
c.name+'}"/>',this.extraEvents[c.name]="blur";else if("TEXT_AREA"==c.type)!1==c.showName&&(e=e+'<span class="zg_resultcardItemTitle">'+c.name+"</span>"),e=e+' <textarea id="'+this.component.id+"_"+c.name+'" >{'+c.name+"}</textarea>",this.extraEvents[c.name]="blur";else if("FACEBOOK_LINK"==c.type){""==b&&(b='<div class="zg_resultcardExtraLinks" style="{zg_'+c.name.replace(RegExp(" ","g"),"_")+'/display: none;}">');b=b+'<div id="zg_resultcardItemLabel">Facebook: <input id="'+this.component.id+"_"+c.name+
'" type="text" value="{'+c.name+'}"/></div>';this.extraEvents[c.name]="blur";continue}else if("TWITTER_LINK"==c.type){""==b&&(b='<div class="zg_resultcardExtraLinks" style="{zg_'+c.name.replace(RegExp(" ","g"),"_")+'/display: none;}">');b=b+'<div id="zg_resultcardItemLabel">Twitter: <input id="'+this.component.id+"_"+c.name+'" type="text" value="{'+c.name+'}"/></div>';this.extraEvents[c.name]="blur";continue}else if("YOUTUBE_LINK"==c.type){""==b&&(b='<div class="zg_resultcardExtraLinks" style="{zg_'+
c.name.replace(RegExp(" ","g"),"_")+'/display: none;}">');b=b+'<div id="zg_resultcardItemLabel">Video: <input id="'+this.component.id+"_"+c.name+'" type="text" value="{'+c.name+'}"/></div>';this.extraEvents[c.name]="blur";continue}else if("WWW_LINK"==c.type){""==b&&(b='<div class="zg_resultcardExtraLinks" style="{zg_'+c.name.replace(RegExp(" ","g"),"_")+'/display: none;}">');b=b+'<div id="zg_resultcardItemLabel">Www: <input id="'+this.component.id+"_"+c.name+'" type="text" value="{'+c.name+'}"/></div>';
this.extraEvents[c.name]="blur";continue}else e=e+" {"+c.name+"}";e+="</div>";zefJQuery(a).append(e)}""!=b&&zefJQuery(a).append(b+"</div>");a=zefJQuery(a).html()}return a};
Zef.FlexCandidateResultCardVisual.prototype.registerEvents=function(){if("undefined"!==this.extraEvents){var a=this,b;for(b in this.extraEvents)"function"!=typeof this.extraEvents[b]&&zefJQuery("#"+this.component.id+"_"+b).bind(this.extraEvents[b],function(){var b=zefJQuery(this).attr("id"),b=b.substring(b.indexOf("_")+1);a.customFieldValueChanged(b,zefJQuery(this).val())})}};
Zef.FlexCandidateResultCardVisual.prototype.customFieldValueChanged=function(a,b){Zef.loadFromServer("saveCustomValue",{m:"saveCustomValue",compId:a,val:b,a:this.component.properties.answererId,id:this.id},function(){},function(){},function(){})};
Zef.FlexCandidateResultCardVisual.prototype.replaceExtraFields=function(a){if("undefined"!==typeof this.component&&"undefined"!==typeof this.component.properties&&null!=this.component.properties){if("undefined"!==typeof this.component.properties.customProperties)for(var b in this.component.properties.customProperties)if("function"!=typeof this.component.properties.customProperties[b]){var d=this.component.properties.customProperties[b].value;"undefined"==typeof d&&(d="");var c=RegExp("{"+this.component.properties.customProperties[b].name+
"}","g");a=a.replace(c,d);c=RegExp("%7B"+this.component.properties.customProperties[b].name+"%7D","g");a=a.replace(c,d)}if("undefined"!==typeof this.component.properties.comps)for(var e=0;e<this.component.properties.comps.length;e++){var f=this.component.properties.comps[e],d=this.component.properties[f.name];"undefined"==typeof d&&(d="");c=RegExp("{"+f.name+"}","g");a=a.replace(c,d);c=RegExp("%7B"+f.name+"%7D","g");a=a.replace(c,d);"imgUrl"==b&&(c=RegExp("{targetImage}","g"),a=a.replace(c,d),c=RegExp("%7BtargetImage%7D",
"g"),a=a.replace(c,d))}for(b in this.component.properties)"function"!=typeof this.component.properties[b]&&(c=RegExp("{"+b+"}","g"),d=this.component.properties[b],"undefined"==typeof d&&(d=""),a=a.replace(c,d),c=RegExp("%7B"+b+"%7D","g"),a=a.replace(c,d),"imgUrl"==b&&(c=RegExp("{targetImage}","g"),a=a.replace(c,d),c=RegExp("%7BtargetImage%7D","g"),a=a.replace(c,d)))}return a};Zef.ChoiceVisual=function(){this.containerClassName="questionContainer"};Zef.ChoiceVisual.prototype=new Zef.Visual;
Zef.ChoiceVisual.prototype.getInputValue=function(){return"undefined"!==typeof this.component.uiValue&&null!==this.component.uiValue?this.component.uiValue:zefJQuery("#"+this.getComponentId()+" option:selected").val()};Zef.ChoiceVisual.prototype.setInputValue=function(a){this.component.uiValue=a;return zefJQuery("#"+this.getComponentId()+" option:selected").val(a)};Zef.TextVisual=function(){this.containerClassName="questionContainer"};Zef.TextVisual.prototype=new Zef.Visual;
Zef.TextVisual.prototype.getInputValue=function(){return null};Zef.TargetTextVisual=function(){this.containerClassName="questionContainer"};Zef.TargetTextVisual.prototype=new Zef.Visual;Zef.TargetTextVisual.prototype.getInputValue=function(){return zefJQuery("#"+this.getComponentId()).val()};Zef.TargetChoiceVisual=function(){this.containerClassName="questionContainer"};Zef.TargetChoiceVisual.prototype=new Zef.Visual;
Zef.TargetChoiceVisual.prototype.getInputValue=function(){return zefJQuery("#"+this.getComponentId()+" option:selected").val()};Zef.TargetChoiceVisual.prototype.setInputValue=function(a){return zefJQuery("#"+this.getComponentId()+" option:selected").val(a)};Zef.GroupingQuestionlistVisual=function(){this.containerClassName="questionListContainer";this.useContainerClassName=!1};Zef.GroupingQuestionlistVisual.prototype=new Zef.Visual;Zef.GroupingQuestionlistVisual.prototype.getInputValue=function(){};
Zef.GroupingQuestionlistVisual.prototype.registerEvents=function(){};Zef.CandidateGroupingQuestionlistVisual=function(){this.containerClassName="questionListContainer";this.useContainerClassName=!0};Zef.CandidateGroupingQuestionlistVisual.prototype=new Zef.GroupingQuestionlistVisual;Zef.ReplyComparisonQuestionListVisual=function(){this.containerClassName="zg_resultcardComparisonValues";this.useContainerClassName=!0};Zef.ReplyComparisonQuestionListVisual.prototype=new Zef.GroupingQuestionlistVisual;
Zef.GroupVisual=function(){this.containerClassName="questionListContent"};Zef.GroupVisual.prototype=new Zef.Visual;Zef.GroupVisual.prototype.getInputValue=function(){};Zef.GroupVisual.prototype.registerEvents=function(){};
Zef.GroupVisual.prototype.replaceExtraFields=function(a){var b=0,d=0,c=this;this.component.components.each(function(a,e){if(e.properties&&(e.properties.f&&e.properties.f==c.component.id)&&("undefined"===typeof e.properties.showInPlayer||!1!==e.properties.showInPlayer))!0==e.questionAnswered&&++b,++d});var e=RegExp("{groupTotalCount}","g");a=a.replace(e,'<span id="group_total_count_'+this.getComponentId()+'">'+d+"</span>");e=RegExp("{groupAnsweredCount}","g");return a=a.replace(e,'<span id="group_answered_count_'+
this.getComponentId()+'">'+b+"</span>")};Zef.GroupVisual.prototype.recalculateAnswered=function(){var a=0,b=0,d=this;this.component.components.each(function(c,e){if(e.properties&&(e.properties.f&&e.properties.f==d.component.id)&&("undefined"===typeof e.properties.showInPlayer||!1!==e.properties.showInPlayer))!0==e.questionAnswered&&++a,++b});zefJQuery("#group_total_count_"+this.getComponentId()).text(b);zefJQuery("#group_answered_count_"+this.getComponentId()).text(a)};
Zef.GroupVisual.prototype.inputValueChanged=function(){this.recalculateAnswered()};Zef.GroupVisual.prototype.constructElementFromTemplate=function(){Zef.Visual.prototype.constructElementFromTemplate.call(this)};Zef.PlayerVisual=function(){this.containerClassName="children"};Zef.PlayerVisual.prototype=new Zef.Visual;Zef.PlayerVisual.prototype.registerEvents=function(){};Zef.PlayerVisual.prototype.getInputValue=function(){};
Zef.QuestionVisual=function(){this.containerClassName="questionContainer";this.disableInCalculation=!1};Zef.QuestionVisual.prototype=new Zef.Visual;Zef.QuestionVisual.prototype.getInputValue=function(){if(this.component&&this.component.questionAnswered)return zefJQuery("#"+this.getComponentId()).slider("option","value")};Zef.QuestionVisual.prototype.setInputValue=function(a){zefJQuery("#"+this.getComponentId()).slider("option","value",a)};Zef.QuestionVisual.prototype.isDisableInCalculation=function(){return this.disableInCalculation};
Zef.QuestionVisual.prototype.getSettings=function(){"undefined"===typeof this.settings&&(this.settings={});this.settings.result=!1;return this.settings};Zef.QuestionVisual.prototype.registerEvents=function(){Zef.Visual.prototype.registerEvents.call(this);var a=this;zefJQuery("#activity_toggler_"+this.getComponentId()).bind("click",function(){a.setToDontKnow()})};
Zef.QuestionVisual.prototype.setToDontKnow=function(){this.setAnswered(!1);this.component.questionAnswered=!1;Zef._questionAnsweredCache[this.component.id]=!1;this.component.player.handleRecalculate();zefJQuery("#"+this.getComponentId()).unbind("slidechange");zefJQuery("#"+this.getComponentId()).slider("option","value",this.component.properties.defaultValue);Zef.Visual.prototype.registerEvents.call(this)};
Zef.QuestionVisual.prototype.checkFilterDisabled=function(){if("undefined"===typeof this.component.properties.filter||!1===this.component.properties.filter){var a=this.component.player.getFilteringQuestions(),b=!1,d;for(d in a)if("function"!=typeof a[d]){var c=a[d].visual.getInputValue();if("undefined"===typeof c||null===c||""==c)b=!0,"undefined"!==typeof this.element&&null!=this.element&&zefJQuery("#"+this.getComponentId()).slider("disable")}!1==b&&"undefined"!==typeof this.element&&null!=this.element&&
zefJQuery("#"+this.getComponentId()).slider("enable")}};Zef.QuestionVisual.prototype.visualDone=function(){this.checkFilterDisabled()};Zef.QuestionVisual.prototype.inputValueChanged=function(a){a!=this.component.properties.id&&this.checkFilterDisabled()};Zef.TargetQuestionVisual=function(){this.containerClassName="questionContainer"};Zef.TargetQuestionVisual.prototype=new Zef.QuestionVisual;
Zef.TargetQuestionVisual.prototype.getUiValue=function(){if("undefined"===typeof this.component.uiValue){var a=this.component.getRepliesByQuestion(this.component.parentComponent.parentComponent.properties);if(a&&(a=a[this.component.id]))return a.v}return this.component.uiValue};Zef.OwnReplyVisual=function(){this.containerClassName="questionContainer"};Zef.OwnReplyVisual.prototype=new Zef.Visual;Zef.OwnReplyVisual.prototype.fireValueChanged=function(){};
Zef.OwnReplyVisual.prototype.registerEvents=function(){};Zef.OwnReplyVisual.prototype.inputValueChanged=function(a,b){Zef.log(a+" "+this.component.properties.id);a==this.component.properties.id&&(this.component.uiValue=b,zefJQuery("#"+this.getComponentId()).value=b,zefJQuery("#"+this.getComponentId()).slider("option","value",b))};Zef.Answer1dVisual=function(){this.containerClassName="questionContainer"};Zef.Answer1dVisual.prototype=new Zef.Visual;Zef.Answer1dVisual.prototype.registerEvents=function(){};
Zef.AnswerTextVisual=function(){this.containerClassName="questionContainer"};Zef.AnswerTextVisual.prototype=new Zef.Visual;Zef.AnswerTextVisual.prototype.registerEvents=function(){};Zef.ResultlistVisual=function(){this.containerClassName="resultListContainer";this.resultsDisplayed=this.useContainerClassName=!1;this.clearContainer=!0;this.loadedResults=[];this.showingTargets=!0;this.searchChanged=!1;this.calculationCache=new Map};Zef.ResultlistVisual.prototype=new Zef.Visual;
Zef.OwnRepliesVisual=function(){this.containerClassName="resultListContainer"};Zef.OwnRepliesVisual.prototype=new Zef.Visual;Zef.ResultlistVisual.prototype.inputValueChanged=function(){this.forceShowAll=!1;!1==this.resultsDisplayed||"undefined"!==typeof this.component.properties.partlyShown&&!0==this.component.properties.partlyShown?(this.showLoading(),this.calculateAndDisplayResults()):(this.showLoading(),this.calculateAndReorderResults());this.hideLoading()};
Zef.ResultlistVisual.prototype.visualDone=function(){Zef.Visual.prototype.visualDone.call(this);if("undefined"!==typeof this.component.properties.compareFolders&&!0===this.component.properties.compareFolders&&"undefined"!==typeof this.component.properties.compareTargets&&!0===this.component.properties.compareTargets){zefJQuery(".player-"+this.component.player.id+" .zg_resultsFolders").show();zefJQuery(".player-"+this.component.player.id+" .zg_resultsTargets").show();this.showingTargets=!0;var a=this;
zefJQuery(".player-"+this.component.player.id+" .zg_resultsFolders").click(function(){a.showingTargets=!1;a.resultsDisplayed=!1;a.forceShowAll=!1;a.component.components.removeAll();a.redrawResults()});zefJQuery(".player-"+this.component.player.id+" .zg_resultsTargets").click(function(){a.showingTargets=!0;a.resultsDisplayed=!1;a.forceShowAll=!1;a.component.components.removeAll();a.redrawResults()})}else this.showingTargets="undefined"!==typeof this.component.properties.compareFolders&&!0===this.component.properties.compareFolders?
!1:!0,zefJQuery(".player-"+this.component.player.id+" .zg_resultsFolders").hide(),zefJQuery(".player-"+this.component.player.id+" .zg_resultsTargets").hide()};Zef.ResultlistVisual.prototype.redrawResults=function(a){!1==this.resultsDisplayed||this.searchChanged||"undefined"!==typeof this.component.properties.partlyShown&&!0==this.component.properties.partlyShown?(this.component.components.removeAll(),this.calculateAndDisplayResults(a)):this.calculateAndReorderResults(a)};
Zef.ResultlistVisual.prototype.calculateAndReorderResults=function(a){a=this.calculateResults(a);null!==a&&this.reorderResults(a)};
Zef.ResultlistVisual.prototype.reorderResults=function(a){var b=1,d;for(d in a)if("function"!=typeof a[d]){this.resultsDisplayed=!0;var c=this.component.components.get(a[d].id);c.properties.o=b++;c.properties.hitNumber=c.properties.o;c.properties.hitPercentage=a[d].percentage;zefJQuery("#_"+c.visual.getComponentId()+"_idx").val(c.properties.o);!1===this.showingTargets?zefJQuery("#_"+c.visual.getComponentId()+"_idx").parent().find(".zg_folderResultHitPercent").text(c.properties.hitPercentage+" %"):
zefJQuery("#_"+c.visual.getComponentId()+"_idx").parent().find(".zg_resultHitPercent").text(c.properties.hitPercentage+" %");zefJQuery("#_"+c.visual.getComponentId()+"_idx").parent().find(".zg_replaceableHitPercent")&&zefJQuery("#_"+c.visual.getComponentId()+"_idx").parent().find(".zg_replaceableHitPercent").text(c.properties.hitPercentage)}a=this.component.components.listValues();a.sort(function(a,b){return a.properties.o>b.properties.o?1:a.properties.o<b.properties.o?-1:0});this.component.components=
new Map;for(b=0;b<a.length;b++)d=a[b],this.component.components.put(d.id,d);var e=zefJQuery(this.getContainerElement()).find(".zg_resultsArea");a=e.children();a.sort(function(a,b){var c=parseInt(zefJQuery(a).find("input[type='hidden']").val()),d=parseInt(zefJQuery(b).find("input[type='hidden']").val());return c>d?1:c<d?-1:0});zefJQuery.each(a,function(a,b){e.append(b)})};Zef.ResultlistVisual.prototype.showLoading=function(){zefJQuery(".zg_loadIndicator").addClass("zg_loadIndicatorLoading")};
Zef.ResultlistVisual.prototype.hideLoading=function(){zefJQuery(".zg_loadIndicator").removeClass("zg_loadIndicatorLoading")};Zef.ResultlistVisual.prototype.getFolder=function(a){for(var b in this.component.properties.folders)if("function"!=typeof this.component.properties.folders[b]){var d=this.component.properties.folders[b];if(d.key==a)return d}return null};
Zef.ResultlistVisual.prototype.calculateResults=function(a){var b=[];if(!1===this.component.hasEnoughAnswers())return b;var d=this.component.player.getRequiredQuestions(),c;for(c in d)if("function"!=typeof d[c]){var e=d[c];!1===this.component.player.questionAnswered(e.id)&&(Zef.log("No reply for a required question, ignoring"),ignore=!0)}d=this.component.player.getFilteringQuestions();if("undefined"!==typeof this.component.properties.loadByFilter&&!0===this.component.properties.loadByFilter){var e=
"",f;for(f in d)if("function"!=typeof d[f]){e=d[f];if("undefined"===typeof e.visual.getInputValue())return b;e="/"+e.id+"__"+e.properties.valType+"__"+e.visual.getInputValue()}if("undefined"===typeof this.loadedRepliesKey||this.loadedRepliesKey!==e){if("undefined"===typeof a||0==a)this.resultsDisplayed=!1,this.component.loadRepliesAndRedraw(e);return null}}this.usePrecalculatedAndDraw()};
Zef.ResultlistVisual.prototype.calculateToLoadedResults=function(a,b){this.loadedResults[a]={};var d=0,c;for(c in this.component.properties.replies)if("function"!=typeof this.component.properties.replies[c]){var e=this.component.properties.replies[c];this.component.getRepliesByQuestion(e);for(var f in e.replies)if("function"!=typeof e.replies[f]){var g=e.replies[f];if(g.q===b){var h=0,j=0,k=this.component.player.getQuestion(g.q);if("undefined"!==typeof k&&null!=k&&("undefined"!==typeof g.v||"undefined"!==
typeof g.va)){if("undefined"!==typeof this.component.player){if(!0==this.component.player.isDisableInCalculation(g.q))continue;if(!0===k.properties.filter)continue;if(!1==this.component.player.questionAnswered(g.q))continue}if("line1d"==k.name){if("undefined"!==typeof this.component.player){var l=this.component.player.getValueForInput(g.q);"number"===typeof l&&(h=Math.abs(g.v-l))}j="undefined"!==typeof k.properties.minValue&&"undefined"!==typeof k.properties.maxValue?100-100*(h/Math.abs(k.properties.minValue-
k.properties.maxValue)):100-100*(h/100)}else"choice"==k.name&&"undefined"!==typeof this.component.player&&(l=this.component.player.getValueForInput(g.q),l==g.va&&(j=100))}this.loadedResults[a][d++]={a:e.answererId,h:j};break}}}};
Zef.ResultlistVisual.prototype.usePrecalculatedAndDraw=function(){var a=this.component.player.getQuestions(),b=[],d=[],c;for(c in a)if("function"!=typeof a[c]){var e=a[c];if(!0===this.component.player.questionAnswered(e.id)){var f="";"undefined"!==typeof this.component.properties.loadByFilter&&!0===this.component.properties.loadByFilter&&"undefined"!==typeof this.loadedRepliesKey&&(f=""+this.loadedRepliesKey+"/vals/");f=f+e.id+"/"+e.visual.getInputValue();if("undefined"===typeof this.loadedResults[f]&&
"undefined"!==typeof this.component.properties.precalculated&&!0===this.component.properties.precalculated){this.component.loadResultsAndCalculate(f);return}"undefined"===typeof this.loadedResults[f]&&this.calculateToLoadedResults(f,e.id);if(!0!==e.properties.filter)for(var g in this.loadedResults[f])e=this.loadedResults[f][g],"function"!=typeof e&&("undefined"===typeof d[e.a]?d[e.a]={total:e.h,count:1}:(d[e.a].total+=e.h,d[e.a].count+=1))}}var a=0,h;for(h in this.component.properties.replies)if(g=
this.component.properties.replies[h],"function"!=typeof g){(e=g.imgUrl)&&(0<=g.imgUrl.indexOf("ggpht.com")&&this.component.properties.scaleSize)&&(e=g.imgUrl+"=s"+this.component.properties.scaleSize);var j="",k="",l;for(l in g.customProperties)if("function"!=typeof g.customProperties[l])if("description"==g.customProperties[l].name||"Description"==g.customProperties[l].name||"DESCRIPTION"==g.customProperties[l].name)j=g.customProperties[l].value;else if("Sound"==g.customProperties[l].name||"sound"==
g.customProperties[l].name||"SOUND"==g.customProperties[l].name)k=g.customProperties[l].value;var n=d[g.answererId],f=c=0;"undefined"!==typeof n&&(f=n.total,c=n.count);if(!1===this.showingTargets){a+=1;e=null;j=-1;"undefined"!==typeof g.folderKey&&null!=g.folderKey&&(j=g.folderKey);for(var m in b)if("function"!=typeof b[m]&&b[m].folderKey==j){e=b[m];break}null==e&&(e={id:j,folderKey:j,name:g.folder},b[a-1]=e,g=this.getFolder(j),"undefined"!==typeof g&&null!=g&&(e.image=g.image,e.imgUrl=g.image),e.totalRawPercentage=
0,e.candidateCount=0,e.properties={});e.totalRawPercentage+=0!=c?f/c:0;++e.candidateCount;e.rawPercentage=e.totalRawPercentage/e.candidateCount;e.percentage=e.rawPercentage.toFixed(1)}else{b[a++]={id:g.answererId,name:g.name,targetImage:e,email:g.email,description:j,percentage:0!=c?(f/c).toFixed(1):"",rawPercentage:0!=c?f/c:-1,sound:k};for(var p in g)"function"!=typeof g[p]&&(b[a-1][p]=g[p])}}b.sort(function(a,b){return a.rawPercentage>b.rawPercentage?-1:a.rawPercentage<b.rawPercentage?1:a.name<b.name?
-1:a.name>b.name?1:0});this.isUseSearch()&&(b=this.performSearch(b));if(("undefined"===typeof this.forceShowAll||!1===this.forceShowAll)&&"undefined"!==typeof this.component.properties.items&&0<this.component.properties.items){d=[];for(m=0;m<this.component.properties.items&&m<b.length;m++)d[m]=b[m];this.component.properties.partlyShown=d.length!=b.length?!0:!1;b=d}!1==this.resultsDisplayed||this.searchChanged||"undefined"!==typeof this.component.properties.partlyShown&&!0==this.component.properties.partlyShown?
this.displayResults(b):this.reorderResults(b)};Zef.ResultlistVisual.prototype.calculateAndDisplayResults=function(a){"undefined"!==typeof this.element&&null!=this.element&&zefJQuery(this.element).find(".zg_resultsArea :gt(0)").detach().removeWithoutLeaking();a=this.calculateResults(a);null!=a&&this.displayResults(a)};Zef.ResultlistVisual.prototype.displayResults=function(a){0===a.length?this.addNoResultsComponent():!1===this.showingTargets?this.displayFolderResults(a):this.displayTargetResults(a)};
Zef.ResultlistVisual.prototype.displayTargetResults=function(a){var b=1,d;for(d in a)if("function"!=typeof a[d]){this.resultsDisplayed=!0;var c=new Zef.TargetResult;c.id=a[d].id;var e={properties:{id:a[d].id,name:a[d].name,email:a[d].email,hitPercentage:a[d].percentage,hitNumber:b++,componentName:"CandidateTarget"}};e.properties.o=e.properties.hitNumber;"undefined"!==typeof this.component.properties.items&&a.length>this.component.properties.items?(e.properties.noFBShare=!0,Zef.resultFBLikeTempDisabled=
!0):Zef.resultFBLikeTempDisabled=!1;"undefined"!==typeof this.component.player.cachedTargetVisual&&(e.uiData=this.component.player.cachedTargetVisual);for(var f in a[d])"function"!=typeof a[d][f]&&(e.properties[f]=a[d][f]);if("undefined"!==typeof this.component.properties.resultDynText&&null!==this.component.properties.resultDynText){var g=this.component.properties.resultDynText,g=g.replace(/{name}/g,a[d].name),g="undefined"!==typeof a[d].email?g.replace(/{email}/g,a[d].email):g.replace(/{email}/g,
""),g=g.replace(/{hitPercentage}/g,"<span class='zg_replaceableHitPercent'>"+e.properties.hitPercentage+"</span>"),g=g.replace(/{percentage}/g,"<span class='zg_replaceableHitPercent'>"+e.properties.hitPercentage+"</span>"),g=g.replace(/{hitNumber}/g,e.properties.hitNumber),g="undefined"!==typeof e.properties.folder?g.replace(/{folder}/g,e.properties.folder):g.replace(/{folder}/g,""),g="undefined"!==typeof e.properties.number?g.replace(/{number}/g,e.properties.number):g.replace(/{number}/g,""),g="undefined"!==
typeof e.properties.description?g.replace(/{description}/g,e.properties.description):g.replace(/{description}/g,""),g="undefined"!==typeof e.properties.price?g.replace(/{price}/g,e.properties.price):g.replace(/{price}/g,"");e.properties.dynText=g}c.setData(e);c.parentComponent=this.component;c.player=this.component.player;if("undefined"===typeof c.parentComponent.visual.settings||null==c.parentComponent.visual.settings)c.parentComponent.visual.settings={};""!=a[d].sound&&"undefined"!==typeof this.component.properties.soundVisual&&
(e=new Zef.QuestionSound,e.uiData=Zef._globalVisualRegistry.getVisual(this.component.properties.soundVisual),e.componentLoadDone=!0,e.uiLoaded=!0,e.id=a[d].id,g={properties:{id:a[d].id,soundFile:a[d].sound}},g.properties.o=0,e.setData(g),e.parentComponent=c,e.player=this.component.player,c.components.put("scomp"+e.id,e),e.buildUi());this.component.components.put(c.id,c);c.componentLoadDone=!0;c.buildUi();e=0;if("undefined"!==this.component.properties.extraComponents)for(var h in this.component.properties.extraComponents)if(g=
this.component.properties.extraComponents[h],"function"!=typeof g){var j=eval("new "+g.component+"()"),k={properties:{}};k.properties.id=g.key;k.properties.name=a[d].name;k.properties.image=a[d].imgUrl;k.properties.percentage=a[d].percentage;k.properties.sharedLink="undefined"!==typeof g.sharedLink&&null!==g.sharedLink?g.sharedLink:"http://{fbShareHost}/fb/{companyFriendlyKey}/{appFriendlyKey}/{answererId}";k.properties.o=e++;for(var l in g.properties)k.properties[l]=g.properties[l];if("undefined"==
typeof k.properties.text||null==k.properties.text)k.properties.text="";j.uiData=Zef._globalVisualRegistry.getVisual(g.visual);j.componentLoadDone=!0;j.uiLoaded=!0;j.setData(k);j.parentComponent=c;j.player=this.component.player;j.buildUi();c.components.put(j.id,j)}}"undefined"!==typeof this.component.properties.partlyShown&&!0===this.component.properties.partlyShown&&this.addShowAllComponent()};
Zef.ResultlistVisual.prototype.addShowAllComponent=function(){if("undefined"!==typeof this.component.properties.items&&0<this.component.properties.items&&!1===this.forceShowAll){var a=new Zef.Result;a.id=this.component.id+"-showAll";var b={properties:{text:this.component.properties.showAllLabel,o:99999,componentName:"ShowAllResults"}};a.uiData=Zef._globalVisualRegistry.getVisual("ShowAllResults");a.componentLoadDone=!0;a.uiLoaded=!0;a.setData(b);a.parentComponent=this.component;a.player=this.component.player;
this.component.components.put(a.id,a);a.buildUi()}};
Zef.ResultlistVisual.prototype.addNoResultsComponent=function(){if("undefined"!==typeof this.component.properties.noResults){var a=new Zef.Result;a.id=this.component.id+"-noResults";var b={properties:{text:this.component.properties.noResults,o:99999,componentName:"ShowAllResults",ignoreEvents:!0}};a.uiData=Zef._globalVisualRegistry.getVisual("ShowAllResults");a.componentLoadDone=!0;a.uiLoaded=!0;a.setData(b);a.parentComponent=this.component;a.player=this.component.player;this.component.components.put(a.id,
a);a.buildUi()}};
Zef.ResultlistVisual.prototype.displayFolderResults=function(a){var b=1,d;for(d in a)if("function"!=typeof a[d]){this.resultsDisplayed=!0;var c=new Zef.TargetResult;c.id=a[d].id;var e={properties:{id:a[d].id,answererId:a[d].id,name:a[d].folderName,hitPercentage:a[d].percentage,hitNumber:b++,componentName:"FolderTarget"}};e.properties.o=e.properties.hitNumber;"undefined"!==typeof this.component.properties.items&&a.length>this.component.properties.items?(e.properties.noFBShare=!0,Zef.resultFBLikeTempDisabled=!0):
Zef.resultFBLikeTempDisabled=!1;"undefined"!==typeof this.component.player.cachedFolderVisual&&(e.uiData=this.component.player.cachedFolderVisual);for(var f in a[d])"function"!=typeof a[d][f]&&(e.properties[f]=a[d][f]);if("undefined"!==typeof this.component.properties.resultDynText&&null!==this.component.properties.resultDynText){var g=this.component.properties.resultDynText,g=g.replace(/{name}/g,a[d].folderName),g=g.replace(/{email}/g,""),g=g.replace(/{hitPercentage}/g,"<span class='zg_replaceableHitPercent'>"+
e.properties.hitPercentage+"</span>"),g=g.replace(/{percentage}/g,"<span class='zg_replaceableHitPercent'>"+e.properties.hitPercentage+"</span>"),g=g.replace(/{hitNumber}/g,e.properties.hitNumber),g="undefined"!==typeof e.properties.folder?g.replace(/{folder}/g,e.properties.folder):g.replace(/{folder}/g,""),g="undefined"!==typeof e.properties.number?g.replace(/{number}/g,e.properties.number):g.replace(/{number}/g,""),g="undefined"!==typeof e.properties.description?g.replace(/{description}/g,e.properties.description):
g.replace(/{description}/g,""),g="undefined"!==typeof e.properties.price?g.replace(/{price}/g,e.properties.price):g.replace(/{price}/g,"");e.properties.dynText=g}c.setData(e);c.parentComponent=this.component;c.player=this.component.player;if("undefined"===typeof c.parentComponent.visual.settings||null==c.parentComponent.visual.settings)c.parentComponent.visual.settings={};""!=a[d].sound&&"undefined"!==typeof this.component.properties.soundVisual&&(e=new Zef.QuestionSound,e.uiData=Zef._globalVisualRegistry.getVisual(this.component.properties.soundVisual),
e.componentLoadDone=!0,e.uiLoaded=!0,e.id=a[d].id,g={properties:{id:a[d].id,soundFile:a[d].sound}},g.properties.o=0,e.setData(g),e.parentComponent=c,e.player=this.component.player,c.components.put("scomp"+e.id,e),e.buildUi());this.component.components.put(c.id,c);c.componentLoadDone=!0;c.buildUi();e=0;if("undefined"!==this.component.properties.extraComponents)for(var h in this.component.properties.extraComponents)if(g=this.component.properties.extraComponents[h],"function"!=typeof g){var j=eval("new "+
g.component+"()"),k={properties:{}};k.properties.id=g.key;k.properties.name=a[d].name;k.properties.percentage=a[d].percentage;k.properties.image=a[d].image;k.properties.sharedLink="undefined"!==typeof g.sharedLink&&null!==g.sharedLink?g.sharedLink:"http://{fbShareHost}/fb/{companyFriendlyKey}/{appFriendlyKey}/{answererId}";k.properties.o=e++;for(var l in g.properties)"function"!=typeof g.properties[l]&&(k.properties[l]=g.properties[l]);if("undefined"==typeof k.properties.text||null==k.properties.text)k.properties.text=
"";j.uiData=Zef._globalVisualRegistry.getVisual(g.visual);j.componentLoadDone=!0;j.uiLoaded=!0;j.setData(k);j.parentComponent=c;j.player=this.component.player;j.buildUi();c.components.put(j.id,j)}}"undefined"!==typeof this.component.properties.partlyShown&&!0===this.component.properties.partlyShown&&this.addShowAllComponent()};Zef.ResultlistVisual.prototype.showAll=function(){this.resultsDisplayed=!1;this.forceShowAll=!0;this.component.components.removeAll();this.redrawResults()};
Zef.ResultlistVisual.prototype.getInputValue=function(){};Zef.ResultlistVisual.prototype.scheduleSearch=function(){"undefined"!==typeof this.scheduledSearch&&null!==this.scheduledSearch&&clearTimeout(this.scheduledSearch);var a=this;this.scheduledSearch=setTimeout(function(){a.redrawResults();a.searchChanged=!1},200)};
Zef.ResultlistVisual.prototype.performSearch=function(a){var b=[],d=this.getSearchTerm();if("undefined"!==typeof d&&null!==d&&""!=d)for(var d=d.toLowerCase(),c=0,e=0;e<a.length;e++){var f=a[e];if("function"!=typeof f&&!("undefined"===typeof f||null===f))"undefined"!==typeof f.name&&null!==f.name&&0<=f.name.toLowerCase().indexOf(d)?(b[c]=a[e],c+=1):"undefined"!==typeof f.email&&null!==f.email&&0<=f.email.toLowerCase().indexOf(d)?(b[c]=a[e],c+=1):"undefined"!==typeof f.description&&null!==f.description&&
0<=f.description.toLowerCase().indexOf(d)?(b[c]=a[e],c+=1):"undefined"!==typeof f.percentage&&null!==f.percentage&&0<=f.percentage.indexOf(d)?(b[c]=a[e],c+=1):"undefined"!==typeof f.folder&&(null!==f.folder&&0<=f.folder.toLowerCase().indexOf(d))&&(b[c]=a[e],c+=1)}else b=a;return b};Zef.ResultlistVisual.prototype.getSearchTerm=function(){return zefJQuery(".zg_resultsSearchField").val()};
Zef.ResultlistVisual.prototype.isUseSearch=function(){return"undefined"!==typeof this.component.properties.useSearch&&!0===this.component.properties.useSearch&&""!=this.getSearchTerm()?!0:!1};
Zef.ResultlistVisual.prototype.registerEvents=function(){if("undefined"!==typeof this.component.properties.useSearch&&!0===this.component.properties.useSearch){var a=this;zefJQuery(".zg_resultsSearchField").keydown(function(){a.searchChanged=!0;a.scheduleSearch()});zefJQuery(".zg_resultsSearch").show()}else zefJQuery(".zg_resultsSearchField").unbind("keydown"),zefJQuery(".zg_resultsSearch").hide()};Zef.ResultVisual=function(){this.containerClassName="zg_resultsArea"};Zef.ResultVisual.prototype=new Zef.Visual;
Zef.ResultVisual.prototype.registerEvents=function(){var a=this;zefJQuery(this.element).bind("click",function(b,d){a.selected="undefined"===typeof a.selected?!0:!a.selected;a.fireItemSelected(d,a.selected)});("undefined"===typeof this.component.properties.noFBShare||!1===this.component.properties.noFBShare)&&Zef.updateFBResultLikeArea()};
Zef.updateFBResultLikeArea=function(){if(!(zefJQuery.browser.msie&&9>parseInt(zefJQuery.browser.version))&&(!("undefined"!==typeof Zef.resultFBLikeTempDisabled&&!0===Zef.resultFBLikeTempDisabled)&&!navigator.userAgent.match(/iPad/i)&&!navigator.userAgent.match(/iPhone/i)&&!navigator.userAgent.match(/Android/i))&&("undefined"==typeof Zef.fbresultLikeUpdatePending||!1===Zef.fbresultLikeUpdatePending))Zef.fbresultLikeUpdatePending=!0,setTimeout("Zef.performFBResultLikeUpdate()",200)};
Zef.performFBResultLikeUpdate=function(){"undefined"!==typeof FB&&FB.XFBML.parse(zefJQuery().find(".zg_resultfbLikeArea").get(0));Zef.fbresultLikeUpdatePending=!1};Zef.updateTwitterLinks=function(){var a,b=document.getElementsByTagName("script")[0];document.getElementById("twitter-wjs")||(a=document.createElement("script"),a.id="twitter-wjs",a.src="//platform.twitter.com/widgets.js",b.parentNode.insertBefore(a,b));!0};Zef.ResultVisual.prototype.drawSelected=function(){zefJQuery(this.element).addClass("zg_resultSelected")};
Zef.ResultVisual.prototype.drawUnselected=function(){zefJQuery(this.element).removeClass("zg_resultSelected")};Zef.ResultVisual.prototype.getStyle=function(a,b){var d=a.indexOf(b);if(0<=d){var c=a.indexOf(";",d+b.length);0>c&&(c=a.length-1);return a.substring(d+b.length+1,c)}return""};
Zef.ResultVisual.prototype.removeAttributeWithValue=function(a,b){if(0<a.indexOf(b)){for(var d=a.indexOf(b),c=-1,e=d;0<=e;e--)if(" "==a.charAt(e)){c=e;break}0<=c&&(d+=b.length," "!=a.charAt(d)&&(d+=1),a=a.substring(0,c)+a.substring(d))}return a};
Zef.ResultVisual.prototype.isVisible=function(a){if("undefined"!==typeof Zef._cachedResultVisibilities&&"undefined"!==typeof Zef._cachedResultVisibilities[a])return Zef._cachedResultVisibilities[a];"undefined"===typeof Zef._cachedResultVisibilities&&(Zef._cachedResultVisibilities={});var b=this.component.parentComponent.visual.settings;if("undefined"!==typeof b&&null!=b&&"undefined"!==typeof b.subComponentStyleNames)for(var d=0;d<b.subComponentStyleNames.length;d++)if(b.subComponentStyleNames[d]==
a)return b=this.getStyle(b.subComponentStyles[d],"display"),Zef._cachedResultVisibilities[a]="none"!=b,"none"!=b;return Zef._cachedResultVisibilities[a]=!0};Zef.ResultVisual.prototype.getStyle=function(a,b){var d=a.indexOf(b);if(0<=d){var c=a.indexOf(";",d+b.length);0>c&&(c=a.length-1);return a.substring(d+b.length+1,c)}return""};
Zef.ResultVisual.prototype.getHTMLTemplate=function(){var a=Zef.Visual.prototype.getHTMLTemplate.call(this);this.isVisible("zg_resultfbLikeArea")&&(a=a.replace(RegExp("{fbLikeContent}","g"),'<fb:like href="http://{fbShareHost}/fb/{companyFriendlyKey}/{appFriendlyKey}/{answererId}" send="false" layout="button_count" width="250" show_faces="false"></fb:like>'));return a};
Zef.ResultVisual.prototype.replaceExtraFields=function(a){var b=this.component.parentComponent.visual.settings;if("undefined"!==typeof b&&null!=b&&"undefined"!==typeof b.subComponentStyleNames)for(var d=0;d<b.subComponentStyleNames.length;d++)if("zgResultImageStyle"==b.subComponentStyleNames[d]){var c=b.subComponentStyles[d];if(c&&"_"!=c){var e=this.getStyle(c,"width");0<e.indexOf("px")&&(e=e.substring(0,e.indexOf("px")));if(null==e||""==e||"null"==e)a=this.removeAttributeWithValue(a,"{imageWidth}");
var f=RegExp("{imageWidth}","g");a=a.replace(f,e);e=this.getStyle(c,"height");0<e.indexOf("px")&&(e=e.substring(0,e.indexOf("px")));if(null==e||""==e||"null"==e)a=this.removeAttributeWithValue(a,"{imageHeight}");f=RegExp("{imageHeight}","g");a=a.replace(f,e)}}return a};Zef.SelectedResultsVisual=function(){this.containerClassName="selectedItemContainer";this.useContainerClassName=!1};Zef.SelectedResultsVisual.prototype=new Zef.Visual;
Zef.FlexResultCardVisual=function(){this.containerClassName="selectedItemContainer";this.useContainerClassName=!1};Zef.FlexResultCardVisual.prototype=new Zef.Visual;Zef.FlexResultCardVisual.prototype.addUiElement=function(){Zef.Visual.prototype.addUiElement.call(this);null!=this.component.selectedProperties&&this.element?zefJQuery(this.element).show():this.element&&zefJQuery(this.element).hide()};
Zef.FlexResultCardVisual.prototype.getHTMLTemplate=function(){var a=Zef.Visual.prototype.getHTMLTemplate.call(this);if("undefined"!=typeof this.component.properties&&null!=this.component.properties&&"undefined"!=typeof this.component.properties.comps){var b="";if(0<=a.indexOf("<script"))var d=a.indexOf("<script"),c=a.indexOf("\x3c/script>")+9,b=a.substring(d,c),a=a.substring(0,d)+a.substring(c);d=a=zefJQuery(a);c=zefJQuery(a).closest(".zg_resultcardFlexArea");c.length?d=c[0]:(c=zefJQuery(a).find(".zg_resultcardFlexArea"),
c.length?d=c[0]:(c=zefJQuery(a).find(".container"),c.length?d=c[0]:(c=zefJQuery(a).find("div"),c.length&&(d=c[0]))));for(c=0;c<this.component.properties.comps.length;c++){var e=this.component.properties.comps[c],f='<div class="zg_resultcardItem" id="zg_resultcardItem_'+e.name.replace(RegExp(" ","g"),"_")+'" style="{zg_'+e.name.replace(RegExp(" ","g"),"_")+'}">';e.showName&&(f=f+'<span class="zg_resultcardItemTitle">'+e.name+"</span>");if("NAME"==e.type)f+=" {name}";else if("EMAIL"==e.type)f+=" {email}";
else if("PARTY"==e.type)f+=' <span class="zg_resultcardParty">{folder}</span>';else if("FACEBOOK_LINK"==e.type){if(!1==this.hasUserValue(e.name))continue;f=f+' <a href="{'+e.name+'}" target="_blank"><img src="common/components/img/facebook.jpg"></img></a>'}else if("TWITTER_LINK"==e.type){if(!1==this.hasUserValue(e.name))continue;f=f+' <a href="{'+e.name+'}" target="_blank"><img src="common/components/img/twitter.jpg"></img></a>'}else if("WWW_LINK"==e.type){if(!1==this.hasUserValue(e.name))continue;
f=f+' <a href="{'+e.name+'}" target="_blank"><span style="width: 100%; height: 100%;">&nbsp;</span></a>'}else if("YOUTUBE_LINK"==e.type){if(!1==this.hasUserValue(e.name))continue;f=f+' <a href="{'+e.name+'}" target="_blank"><img src="common/components/img/video.jpg"></img></a>'}else if("TARGET_IMAGE"==e.type){f+='<img src="{targetImage}" ';e="zg_"+e.name.replace(RegExp(" ","g"),"_");if("undefined"!==typeof this.settings&&"undefined"!==typeof this.settings.subComponentStyles){for(var g=-1,h=0;h<this.settings.subComponentStyleNames.length;h++)if(this.settings.subComponentStyleNames[h]==
e){g=h;break}if(0<=g&&(e=this.settings.subComponentStyles[g])&&"_"!=e)g=this.getStyle(e,"width"),0<g.indexOf("px")&&(g=g.substring(0,g.indexOf("px"))),null!=g&&(""!=g&&"null"!=g)&&(f=f+'width="'+g+'" '),g=this.getStyle(e,"height"),0<g.indexOf("px")&&(g=g.substring(0,g.indexOf("px"))),null!=g&&(""!=g&&"null"!=g)&&(f=f+'height="'+g+'" ')}f+="></img>"}else if("IMAGE"==e.type){if(!1==this.hasUserValue(e.name))continue;f=f+' <img src="{'+e.name+'}" ';e="zg_"+e.name.replace(RegExp(" ","g"),"_");if("undefined"!==
typeof this.settings&&"undefined"!==typeof this.settings.subComponentStyles){g=-1;for(h=0;h<this.settings.subComponentStyleNames.length;h++)if(this.settings.subComponentStyleNames[h]==e){g=h;break}if(0<=g&&(e=this.settings.subComponentStyles[g])&&"_"!=e)g=this.getStyle(e,"width"),0<g.indexOf("px")&&(g=g.substring(0,g.indexOf("px"))),null!=g&&(""!=g&&"null"!=g)&&(f=f+'width="'+g+'" '),g=this.getStyle(e,"height"),0<g.indexOf("px")&&(g=g.substring(0,g.indexOf("px"))),null!=g&&(""!=g&&"null"!=g)&&(f=
f+'height="'+g+'" ')}f+="></img>"}else if("LABEL"==e.type)f=f+'<span class="zg_resultcardItemLabel">'+e.name+"</span>";else if("TEXT_AREA"==e.type){if(!1==this.hasUserValue(e.name))continue;f=f+'<div class="zg_resultcardItemTextArea">{'+e.name+"}</div>"}else{if(!1==this.hasUserValue(e.name))continue;f=f+" {"+e.name+"}"}f+="</div>";zefJQuery(d).append(f)}a=b+'<div class="zg_resultcard">'+zefJQuery(a).html()+"</div>"}return a};
Zef.FlexResultCardVisual.prototype.getStyle=function(a,b){var d=a.indexOf(b);if(0<=d){var c=a.indexOf(";",d+b.length);0>c&&(c=a.length-1);return a.substring(d+b.length+1,c)}return""};Zef.FlexResultCardVisual.prototype.getSettings=function(){"undefined"===typeof this.settings&&(this.settings={});this.settings.result=!1;return this.settings};
Zef.FlexResultCardVisual.prototype.hasUserValue=function(a){var b=!1;if("undefined"!==typeof this.component&&"undefined"!==typeof this.component.selectedProperties&&null!=this.component.selectedProperties){b="undefined"!==typeof this.component.selectedProperties[a]&&"undefined"!==typeof this.component.selectedProperties[a].value&&null!=this.component.selectedProperties[a].value;if(!0==b)return b;if("undefined"!==typeof this.component.selectedProperties.customProperties)for(var d in this.component.selectedProperties.customProperties)if("function"!=
typeof this.component.selectedProperties.customProperties[d]&&this.component.selectedProperties.customProperties[d].name==a&&"undefined"!==typeof this.component.selectedProperties.customProperties[d].value&&null!=this.component.selectedProperties.customProperties[d].value){b=!0;break}}return b};
Zef.FlexResultCardVisual.prototype.registerLinkEvents=function(){for(var a=0;a<this.component.properties.comps.length;a++){var b=this.component.properties.comps[a],d="zg_resultcardItem_"+b.name.replace(RegExp(" ","g"),"_");if("WWW_LINK"==b.type&&this.hasUserValue(b.name)){var c=this;new function(a){zefJQuery("#"+d).click(function(){var b=c.component.selectedProperties[a];if(("undefined"===typeof b||null===b)&&"undefined"!==typeof c.component.selectedProperties.customProperties)for(var d in c.component.selectedProperties.customProperties)"function"!=
typeof c.component.selectedProperties.customProperties[d]&&c.component.selectedProperties.customProperties[d].name==a&&(b=c.component.selectedProperties.customProperties[d].value);"undefined"!==typeof b&&null!=b&&(0>b.indexOf("http")&&(b="http://"+b),window.open(b,"_blank"))})}(b.name)}}};
Zef.FlexResultCardVisual.prototype.replaceExtraFields=function(a){if("undefined"!==typeof this.component&&"undefined"!==typeof this.component.selectedProperties&&null!=this.component.selectedProperties){for(var b in this.component.selectedProperties)if("function"!=typeof this.component.selectedProperties[b]){var d=RegExp("{"+b+"}","g"),c=this.component.selectedProperties[b];"undefined"!==typeof b&&("targetImage"==b&&"undefined"!==typeof c&&null!=c)&&(0<=c.indexOf("ggpht.com")&&this.component.properties.scaleSize)&&
(0<c.indexOf("=s")&&(c=c.substring(0,c.indexOf("=s"))),c=c+"=s"+this.component.properties.scaleSize);a=a.replace(d,c);d=RegExp("%7B"+b+"%7D","g");a=a.replace(d,c)}if("undefined"!==typeof this.component.selectedProperties.customProperties)for(b in this.component.selectedProperties.customProperties)if("function"!=typeof this.component.selectedProperties.customProperties[b]){c=this.component.selectedProperties.customProperties[b].value;"undefined"!==typeof this.component.selectedProperties.customProperties[b].name&&
("targetImage"==this.component.selectedProperties.customProperties[b].name&&"undefined"!==typeof c&&null!=c)&&(0<=c.indexOf("ggpht.com")&&this.component.properties.scaleSize)&&(0<c.indexOf("=s")&&(c=c.substring(0,c.indexOf("=s"))),c=c+"=s"+this.component.properties.scaleSize);if("undefined"===typeof c||null==c)c="";d=RegExp("{"+this.component.selectedProperties.customProperties[b].name+"}","g");a=a.replace(d,c);d=RegExp("%7B"+this.component.selectedProperties.customProperties[b].name+"%7D","g");a=
a.replace(d,c)}}return a};Zef.PopupFlexResultCardVisual=function(){this.containerClassName="selectedItemContainer";this.useContainerClassName=!1};Zef.PopupFlexResultCardVisual.prototype=new Zef.FlexResultCardVisual;Zef.PopupFlexResultCardVisual.prototype.getContainerElement=function(){return this.popupElement};Zef.PopupFlexResultCardVisual.prototype.addUiElement=function(){this.component.selectedProperties?(this.popupElement=zefJQuery("<div></div>"),Zef.Visual.prototype.addUiElement.call(this)):zefJQuery(this.element).hide()};
Zef.PopupFlexResultCardVisual.prototype.visualDone=function(){Zef.Visual.prototype.visualDone.call(this);null!=this.component.selectedProperties&&this.element?zefJQuery(this.element).show():this.element&&zefJQuery(this.element).hide()};
Zef.PopupFlexResultCardVisual.prototype.registerEvents=function(){if(this.component.selectedProperties){if("undefined"!==typeof this.component.selectedProperties.componentName&&"FolderTarget"===this.component.selectedProperties.componentName)return;var a=400;"undefined"!==typeof this.component.properties.popupWidth&&(a=this.component.properties.popupWidth);var b=this.component.properties.resultCardName;!0===this.component.properties.targetNameAsTitle&&(b=this.component.selectedProperties.name);zefJQuery(this.popupElement).dialog({dialogClass:"zg_resultcardDialog player-"+
this.component.player.id,title:b,height:500,width:a,modal:!0});zefJQuery(".zg_resultcardDialog").position({my:"center top",at:"center top",of:".player"});"undefined"!==typeof FB&&FB.XFBML.parse(zefJQuery(".zg_fbLikeArea").get(0))}this.registerLinkEvents()};Zef.FacebookShareVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1};Zef.FacebookShareVisual.prototype=new Zef.Visual;
Zef.FacebookShareVisual.prototype.registerEvents=function(){var a=this,b=!1;setTimeout(function(){var d=a.component.player.components.get("ResultList");d&&(d.components&&0<d.components.size)&&(b=!0,zefJQuery(".zg_facebookShareLink").show());!1===b&&zefJQuery(".zg_facebookShareLink").hide();zefJQuery(".zg_facebookShareLink").bind("click",function(){a.performFacebookShare()})},150)};
Zef.FacebookShareVisual.prototype.inputValueChanged=function(){var a=this,b=!1;setTimeout(new function(){var d=a.component.player.components.get("ResultList");d&&(d.components&&0<d.components.size)&&(b=!0,zefJQuery(".zg_facebookShareLink").show());!1===b&&zefJQuery(".zg_facebookShareLink").hide()},150)};
Zef.FacebookShareVisual.prototype.performFacebookShare=function(){Zef.log("sharing to facebook!");var a=this.component.player.components.get("ResultList");if(a&&a.components&&0<a.components.size){var b=this.component.properties.showImage?a.components.get(a.components.listKeys()[0]).properties.imgUrl:"";b&&"//"==b.substring(0,2)&&(b="http:"+b);for(var b={method:"feed",link:this.replaceFields(this.component.properties.sharedLink),picture:b,name:this.component.properties.shareName,caption:this.component.properties.shareTitle,
description:""},d=0;d<this.component.properties.amountToShare;){++d;var c=null;a.components.each(function(a,b){b.properties&&(b.properties.o&&b.properties.o==d)&&(c=b)});null!=c&&(1==d&&(b.picture=this.component.properties.showImage?c.properties.imgUrl:"",b.picture&&"//"==b.picture.substring(0,2)&&(b.picture="http:"+b.picture)),b.description=1<this.component.properties.amountToShare?b.description+d+". "+c.properties.name+" ":b.description+" "+c.properties.name+" ",b.description=b.description+(this.component.properties.showHitPercentage?
c.properties.hitPercentage+"%":"")+"  ")}"undefined"!==typeof FB&&FB.ui(b,new function(a){Zef.log("received reply for facebook share, the reply is "+a)})}};Zef.FacebookCommentingVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1};Zef.FacebookCommentingVisual.prototype=new Zef.Visual;Zef.FacebookCommentingVisual.prototype.registerEvents=function(){"undefined"!==typeof FB&&FB.XFBML.parse(zefJQuery(".zg_facebookCommenting").get(0))};
Zef.InfoPopupButtonVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1;this.htmlSrc="dont_load";Zef.loadedHtmlComponents[this.htmlSrc].html="dont_load"};Zef.InfoPopupButtonVisual.prototype=new Zef.Visual;Zef.InfoPopupButtonVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_infoPopupButton").bind("click",function(){a.showInfoPopup()})};Zef.InfoPopupButtonVisual.prototype.showInfoPopup=function(){this.popup&&popup.showInfoPopup()};
Zef.InfoPopupButtonVisual.prototype.getHTMLTemplate=function(){return'<div class="zg_infoPopupButton">{buttonTitle}</div>'};Zef.InfoPopupVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1;this.button=new Zef.InfoPopupButtonVisual;this.button.popup=this};Zef.InfoPopupVisual.prototype=new Zef.Visual;Zef.InfoPopupVisual.prototype.getContainerElement=function(){return this.popupElement};
Zef.InfoPopupVisual.prototype.addUiElement=function(){this.button.addUiElement();this.popupElement=zefJQuery("<div></div>");Zef.Visual.prototype.addUiElement.call(this)};
Zef.InfoPopupVisual.prototype.showInfoPopup=function(){var a=520;if("undefined"!==typeof this.settings&&"undefined"!==typeof this.settings.subComponentStyles){for(var b=-1,d=0;d<this.settings.subComponentStyleNames.length;d++)if("zgInfoPopupWidth"==this.settings.subComponentStyleNames[d]){b=d;break}0<=b&&(a=this.settings.subComponentStyles[b],"string"===typeof a&&0<a.indexOf("px")&&(a=a.substring(0,a.length-2)),a=parseInt(a)+20)}zefJQuery(this.popupElement).dialog({dialogClass:"zg_infoPopupDialog",
title:this.component.properties.title,height:500,width:a,position:[70,140],modal:!0})};Zef.LinkVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0};Zef.LinkVisual.prototype=new Zef.Visual;
Zef.InfoPopupButtonVisual=function(){this.containerClassName="player";this.htmlSrc="dont_load";Zef.loadedHtmlComponentStatuses[this.htmlSrc]="loaded";Zef.loadedHtmlComponents[this.htmlSrc]={};Zef.loadedHtmlComponents[this.htmlSrc].html="dont_load";this.skipStyle=this.skipOrder=!0};Zef.InfoPopupButtonVisual.prototype=new Zef.Visual;Zef.InfoPopupButtonVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_infoPopupButton").bind("click",function(){a.showInfoPopup()})};
Zef.InfoPopupButtonVisual.prototype.showInfoPopup=function(){this.popup&&this.popup.showInfoPopup()};Zef.InfoPopupButtonVisual.prototype.getHTMLTemplate=function(){return'<div class="zg_infoPopupButton">{infoPopupButton}</div>'};Zef.InfoPopupVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1;this.button=new Zef.InfoPopupButtonVisual;this.button.popup=this};Zef.InfoPopupVisual.prototype=new Zef.Visual;Zef.InfoPopupVisual.prototype.getContainerElement=function(){return this.popupElement};
Zef.InfoPopupVisual.prototype.addUiElement=function(){this.button.component=new Zef.Component;this.button.component.id=this.component.id;this.button.component.player=this.component.player;this.button.component.componentLoadDone=!0;this.button.component.name="InfoPopupButton";this.button.component.parentComponent=this.component.parentComponent;this.button.component.properties=this.component.properties;this.button.constructElementFromTemplate();this.popupElement=zefJQuery("<div></div>");Zef.Visual.prototype.addUiElement.call(this)};
Zef.InfoPopupVisual.prototype.showInfoPopup=function(){var a=520,b=500;"undefined"!==typeof this.settings&&null!=this.settings&&("undefined"!==typeof this.settings.width&&(null!=this.settings.width&&0<this.settings.width)&&(a=this.settings.width),"undefined"!==typeof this.settings.height&&(null!=this.settings.height&&0<this.settings.height)&&(b=this.settings.height));zefJQuery(this.popupElement).dialog({dialogClass:"zg_infoPopupDialog",title:this.component.properties.infoPopupTitle,height:b,width:a,
position:[70,140],modal:!0})};Zef.TwitterShareVisual=function(){this.containerClassName="questionContainer";this.useContainerClassName=!1};Zef.TwitterShareVisual.prototype=new Zef.Visual;Zef.TwitterShareVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_twitterShareLink").bind("click",function(){a.performShare()})};
Zef.TwitterShareVisual.prototype.performShare=function(){Zef.log("sharing to twitter!");var a=this.component.player.components.get("ResultList");if(a&&a.components&&0<a.components.size){for(var b=this.component.properties.shareText+" ",d=0;d<this.component.properties.amountToShare;){++d;var c=null;a.components.each(function(a,b){b.properties&&(b.properties.o&&b.properties.o==d)&&(c=b)});null!=c&&(b=1<this.component.properties.amountToShare?b+d+". "+c.properties.name+" ":b+" "+c.properties.name+" ",
b=b+(this.component.properties.showHitPercentage?c.properties.hitPercentage+"%":"")+" ")}a="https://twitter.com/share?url="+this.component.properties.sharedLink+"&hashtags="+encodeURI(this.component.properties.hashTags)+"&text="+encodeURI(b);this.component.properties.via&&(a=a+"&via="+encodeURI(this.component.properties.via));window.open(a,"twitterPopup","height=300,width=500,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes")}};
Zef.QuestionSoundVisual=function(){this.containerClassName="question";this.skipStyle=!0;this.loaded=this.playing=!1};Zef.QuestionSoundVisual.prototype=new Zef.Visual;Zef.QuestionSoundVisual.prototype.registerEvents=function(){var a=this;zefJQuery("#"+this.getComponentId()).bind("click",function(b){a.toggleSound();b.stopPropagation()})};Zef.QuestionSoundVisual.prototype.getSound=function(){return this.component.properties.soundFile};
Zef.QuestionSoundVisual.prototype.toggleSound=function(){if(!1==this.loaded){var a=this;zefJQuery("#"+this.getComponentId()+"_snd").jPlayer("stop");zefJQuery("#"+this.getComponentId()+"_snd").jPlayer({ready:function(){zefJQuery(this).jPlayer("setMedia",{mp3:a.getSound()}).jPlayer("play");a.playing=!0;a.loaded=!0},solution:"flash, html",swfPath:"/js"})}else!1==this.playing?(zefJQuery("#"+this.getComponentId()+"_snd").jPlayer("play"),this.playing=!0):(zefJQuery("#"+this.getComponentId()+"_snd").jPlayer("stop"),
this.playing=!1)};Zef.CandidateSoundVisual=function(){this.containerClassName="zg_result";this.skipStyle=!0;this.loaded=this.playing=!1};Zef.CandidateSoundVisual.prototype=new Zef.QuestionSoundVisual;Zef.ResultCardSoundVisual=function(){this.containerClassName="selectedResults_added";this.skipStyle=!0;this.loaded=this.playing=!1};Zef.ResultCardSoundVisual.prototype=new Zef.QuestionSoundVisual;
Zef.ResultCardSoundVisual.prototype.getSound=function(){if("undefined"!==typeof this.component.parentComponent&&"undefined"!==typeof this.component.parentComponent.selectedProperties&&"undefined"!==typeof this.component.parentComponent.selectedProperties.customProperties)for(var a in this.component.parentComponent.selectedProperties.customProperties)if("function"!=typeof this.component.parentComponent.selectedProperties.customProperties[a]&&"function"!=typeof this.component.parentComponent.selectedProperties.customProperties[a]&&
this.component.parentComponent.selectedProperties.customProperties[a].name==this.component.properties.soundFile)return this.component.parentComponent.selectedProperties.customProperties[a].value};Zef.ResultCardSoundVisual.prototype.addUiElement=function(){"undefined"!==typeof this.getSound()&&Zef.Visual.prototype.addUiElement.call(this)};Zef.ResultProgressVisual=function(){this.containerClassName="resultListContainer";this.useContainerClassName=!1};Zef.ResultProgressVisual.prototype=new Zef.Visual;
Zef.ResultProgressVisual.prototype.inputValueChanged=function(){this.refreshProgress()};Zef.ResultProgressVisual.prototype.visualDone=function(){Zef.Visual.prototype.visualDone.call(this);this.refreshProgress()};
Zef.ResultProgressVisual.prototype.refreshProgress=function(){var a=0,b=0;if(this.component.properties.progressList&&this.component.properties.progressList[0]&&this.component.properties.progressList[0].onlyRequired){var d=this.component.player.getRequiredQuestions(),c;for(c in d)"function"!=typeof d[c]&&(b+=1,!0===this.component.player.questionAnswered(d[c].id)&&(a+=1))}else a=this.component.player.answeredQuestionCount(),b=this.component.player.getQuestionCount();d=0;0<b&&(d=Math.round(100*(a/b)));
c=null;if("undefined"!==typeof this.component.properties.progressList&&null!=this.component.properties.progressList)for(var e=0;e<this.component.properties.progressList.length;e++){var f=this.component.properties.progressList[e];null==c&&f.progress<=d?c=f:null!=d&&(f.progress<=d&&f.progress>c.progress)&&(c=f)}zefJQuery(".zg_answeringProgress").removeClass().addClass("zg_answeringProgress").addClass("zg_answeringProgress_progress_"+d);null!=c&&(c.progress!=d&&zefJQuery(".zg_answeringProgress").addClass("zg_answeringProgress_progress_"+
c.progress),e=c.title,c=c.content,f=RegExp("{repliedCount}","g"),c=c.replace(f,'<span id="progress_replied_count_'+this.getComponentId()+'">'+a+"</span>"),e=e.replace(f,'<span id="progress_replied_count_'+this.getComponentId()+'">'+a+"</span>"),f=RegExp("{totalCount}","g"),c=c.replace(f,'<span id="progress_total_count_'+this.getComponentId()+'">'+b+"</span>"),e=e.replace(f,'<span id="progress_total_count_'+this.getComponentId()+'">'+b+"</span>"),f=RegExp("{progress}","g"),c=c.replace(f,'<span id="progress_percentage_'+
this.getComponentId()+'">'+d+"</span>"),e=e.replace(f,'<span id="progress_percentage_'+this.getComponentId()+'">'+d+"</span>"),zefJQuery(".zg_answeringProgressTitle").html(e),zefJQuery(".zg_answeringProgressImage").html(""),zefJQuery(".zg_answeringProgressContent").html(c));zefJQuery("#progress_replied_count_"+this.getComponentId()).text(a);zefJQuery("#progress_total_count_"+this.getComponentId()).text(b);zefJQuery("#progress_percentage_"+this.getComponentId()).text(d)};
Zef.ResultProgressVisual.prototype.setData=function(a){Zef.Visual.prototype.setData.call(this,a);"undefined"!==typeof this.component.properties&&(null!=this.component.properties&&"undefined"!==typeof this.component.properties.containerClass&&null!=this.component.properties.containerClass)&&(this.containerClassName=this.component.properties.containerClass,this.useContainerClassName=!0)};
Zef.ResultProgressVisual.prototype.replaceExtraFields=function(a){var b=0,d=0;if(this.component.properties.progressList&&this.component.properties.progressList[0]&&this.component.properties.progressList[0].onlyRequired){var c=this.component.player.getRequiredQuestions(),e;for(e in c)"function"!=typeof c[e]&&(d+=1,!0===this.component.player.questionAnswered(c[e].id)&&(b+=1))}else b=this.component.player.answeredQuestionCount(),d=this.component.player.getQuestionCount();c=0;0<d&&(c=Math.round(100*(b/
d)));e=RegExp("{repliedCount}","g");a=a.replace(e,'<span id="progress_replied_count_'+this.getComponentId()+'">'+b+"</span>");e=RegExp("{totalCount}","g");a=a.replace(e,'<span id="progress_total_count_'+this.getComponentId()+'">'+d+"</span>");e=RegExp("{progress}","g");return a=a.replace(e,'<span id="progress_percentage_'+this.getComponentId()+'">'+c+"</span>")};Zef.DynamicContentVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0};
Zef.DynamicContentVisual.prototype=new Zef.Visual;Zef.DynamicContentVisual.prototype.showContent=function(a){"undefined"!==typeof this.element&&zefJQuery(this.element).find(".zg_dynamicContent").html(a)};Zef.TargetComparingVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0};Zef.TargetComparingVisual.prototype=new Zef.Visual;
Zef.TargetComparingVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_targetComparing").addClass("player-"+this.component.player.id);zefJQuery(".zg_targetComparingDialog").addClass("player-"+this.component.player.id);zefJQuery(".zg_targetComparing").bind("click",function(){a.showPopup();return!1})};Zef.TargetComparingVisual.prototype.showPopup=function(){zefJQuery(".zg_targetComparingPopup").dialog("open")};Zef.ShowAllResultsVisual=function(){this.containerClassName="zg_resultsArea"};
Zef.ShowAllResultsVisual.prototype=new Zef.Visual;Zef.ShowAllResultsVisual.prototype.registerEvents=function(){if(!("undefined"!==typeof this.component.properties.ignoreEvents&&!0===this.component.properties.ignoreEvents)){var a=this;zefJQuery(this.element).click(function(){a.component.parentComponent.visual.showAll()})}};
Zef.ResultFBShareVisual=function(){this.containerClassName="result_fbshares";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.clearContainer=!1;this.addParentIdToComponentId=!0};Zef.ResultFBShareVisual.prototype=new Zef.Visual;Zef.ResultFBShareVisual.prototype.registerEvents=function(){Zef.Visual.prototype.registerEvents.call(this);var a=this;zefJQuery("#"+this.getComponentId()).bind("click",function(){a.performShare();return!1})};
Zef.ResultFBShareVisual.prototype.replaceResultFields=function(a){a=a.replace(/{name}/g,this.component.properties.name);return a=a.replace(/{percentage}/g,this.component.properties.percentage)};
Zef.ResultFBShareVisual.prototype.performShare=function(){if(this.component.properties){var a=this.component.properties.image;a&&"//"==a.substring(0,2)&&(a="http:"+a);var b=this.component.properties.shareName,b="undefined"===typeof b||null===b?"":this.replaceResultFields(b),d=this.component.properties.shareCaption,d="undefined"===typeof d||null===d?"":this.replaceResultFields(d),c=this.component.properties.shareDescription,c="undefined"===typeof c||null===c?"":this.replaceResultFields(c),a={method:"feed",
link:this.replaceFields(this.component.properties.sharedLink),picture:a,name:b,caption:d,description:c};"undefined"!==typeof FB&&FB.ui(a,new function(a){Zef.log("received reply for facebook share, the reply is "+a)})}};Zef.ResultTwitterShareVisual=function(){this.containerClassName="result_fbshares";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.clearContainer=!1;this.addParentIdToComponentId=!0};Zef.ResultTwitterShareVisual.prototype=new Zef.Visual;
Zef.ResultTwitterShareVisual.prototype.registerEvents=function(){Zef.Visual.prototype.registerEvents.call(this);var a=this;zefJQuery("#"+this.getComponentId()).bind("click",function(){a.performShare();return!1})};Zef.ResultTwitterShareVisual.prototype.replaceResultFields=function(a){a=a.replace(/{name}/g,this.component.properties.name);return a=a.replace(/{percentage}/g,this.component.properties.percentage)};
Zef.ResultTwitterShareVisual.prototype.performShare=function(){if(this.component.properties){var a=this.component.properties.shareName,a="undefined"===typeof a||null===a?"":this.replaceResultFields(a),a="https://twitter.com/share?url="+this.replaceFields(this.component.properties.sharedLink)+"&text="+encodeURI(a);this.component.properties.shareHashTags&&(a=a+"&hashtags="+encodeURI(this.component.properties.shareHashTags));this.component.properties.shareVia&&(a=a+"&via="+encodeURI(this.component.properties.shareVia));
window.open(a,"twitterPopup","height=300,width=500,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes")}};Zef.StartInfoVisual=function(){this.containerClassName="player";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.data=null};Zef.StartInfoVisual.prototype=new Zef.Visual;
Zef.StartInfoVisual.prototype.registerEvents=function(){this.addGuessedElement();this.addFriendGuessStats();Zef.Visual.prototype.registerEvents.call(this);var a=this;zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoGo").bind("click",function(){a.goToPlayer()});this.component.properties.cancelLink&&zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoCancel").html(this.component.properties.cancelLink)};
Zef.StartInfoVisual.prototype.goToPlayer=function(){Zef._startInfoShown=!0;zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoGo").parent().hide()};Zef.StartInfoVisual.prototype.addFriendGuessElement=function(a){var b=document.createElement("div");b.setAttribute("class","zg_startInfoFriend");FB.api({method:"fql.query",query:"SELECT name, pic_square FROM user WHERE uid = "+a.f},function(a){b.innerHTML=a[0].name});return b};
Zef.StartInfoVisual.prototype.addFriendGuessStats=function(){if(this.component.dataFromServer){var a=this.component.getGuessesForResult(this.component.dataFromServer.id),b=0;if(this.component.properties.numOfFriends){for(var d=0,b=0;d<this.component.properties.numOfFriends&&b<a.length;b++)if("function"!=typeof a[b]){var c=this.addFriendGuessElement(a[b]);zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoFriends").append(zefJQuery(c));d+=1}b=d}if(this.component.properties.otherFriendsLabel){var d=
0,e;for(e in a)"function"!=typeof e&&(d+=1);d-=b;0<d&&(a=this.component.properties.otherFriendsLabel,a=a.replace(/{otherNum}/g,d),zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoFriends").append(zefJQuery('<div class="zg_startInfoOtherFriends">'+a+"</div>")))}}};
Zef.StartInfoVisual.prototype.addGuessedElement=function(){var a=this.component.dataFromServer;if(a&&a.id){var b=this.component.player.getResult(a.id);if(b){var d=zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoTitle").html(),d=d.replace(/{resultName}/g,b.name);zefJQuery(".zg_startInfo"+this.getComponentId()+" .zg_startInfoTitle").html(d);var c=new Zef.TargetResult;c.id=a.id;a={properties:{id:a.id,name:b.name,email:b.email,hitPercentage:"",hitNumber:"",componentName:"CandidateTarget"}};
a.properties.o=1;a.properties.noFBShare=!0;"undefined"!==typeof this.component.player.cachedTargetVisual&&(a.uiData=this.component.player.cachedTargetVisual);for(var e in b)"function"!=typeof b[e]&&(a.properties[e]=b[e]);a.properties.imgUrl&&"undefined"===typeof a.properties.targetImage&&(a.properties.targetImage=a.properties.imgUrl,"undefined"!==typeof a.properties.targetImage&&0==a.properties.targetImage.indexOf("//")&&(a.properties.targetImage="https:"+a.properties.targetImage));if(b.customProperties)for(var f in b.customProperties)"function"!=
typeof b.customProperties[f]&&(b.customProperties[f].name&&b.customProperties[f].value)&&(d=b.customProperties[f].name,"undefined"==typeof a.properties[d]&&(a.properties[d]=b.customProperties[f].value),d=d.toLowerCase(),"undefined"==typeof a.properties[d]&&(a.properties[d]=b.customProperties[f].value));c.buildVisual=function(a){null==c.visual&&(c.visual=eval("new "+a.visual+"()"));c.visual.containerClassName="zg_startInfoGuessedResult";Zef.Component.prototype.buildVisual.call(this,a)};c.setData(a);
c.parentComponent=this.component;c.player=this.component.player;if("undefined"===typeof c.parentComponent.visual.settings||null==c.parentComponent.visual.settings)c.parentComponent.visual.settings={};this.component.components.put(c.id,c);c.componentLoadDone=!0;c.buildUi()}}this.component.startInfoVisualDone()};Zef.FBCompareVisual=function(){this.containerClassName="player";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.classStart="zg_fbCompare";this.mouseoverPopup=null};
Zef.FBCompareVisual.prototype=new Zef.Visual;Zef.FBCompareVisual.prototype.constructElementFromTemplate=function(){var a=this;"undefined"==typeof this.component.player.fbFriendResults||null==this.component.player.fbFriendResults?this.component.loadFbFriendResults(function(){Zef.Visual.prototype.constructElementFromTemplate.call(a)}):Zef.Visual.prototype.constructElementFromTemplate.call(this)};
Zef.FBCompareVisual.prototype.registerEvents=function(){var a=this,b=this.component.player.getBestResult();if(b){var d=document.createElement("img");d.setAttribute("src",b.properties.imgUrl);zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"ResultImage").append(jQuery(d));this.component.properties.resultExtraLink&&(b=this.getResultProperty(this.component.properties.resultExtraLink,b))&&zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"ResultExtraLink").html(b)}"undefined"!==
typeof FB&&(this.component.properties.shareButton&&zefJQuery(".zg_fbCompare"+this.getComponentId()+" .zg_fbCompareShareButton").bind("click",function(){a.performShare()}),FB.api("/me",function(b){a.myid=b.id;FB.api("/me/friends",function(b){var c=[],d=!1,h;for(h in b.data)"function"!=typeof b.data[h]&&!0==a.component.hasAnswer(b.data[h].id)&&(d=!0,c.push(b.data[h]));d?a.drawFriendList(c):a.drawNoResults();a.drawFriendGuesses()})}))};
Zef.FBCompareVisual.prototype.drawNoResults=function(){if(this.component.properties.noAnswersText){var a=document.createElement("div");a.setAttribute("class",this.classStart+"NoResults");a.innerHTML=this.component.properties.noAnswersText;zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendList").append(jQuery(a))}if(this.component.properties.seeAll){a=document.createElement("div");a.setAttribute("class",this.classStart+"NoResultsSeeAll");a.innerHTML=this.component.properties.seeAll;
zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendList").append(jQuery(a));var b=this;zefJQuery(a).bind("click",function(){b.component.player.showComponent(b.component.properties.seeAllComponent)})}};
Zef.FBCompareVisual.prototype.performShare=function(){var a=this.component.player.getBestResult();if(!("undefined"===typeof a||null==a)){var b=this;if("undefined"==typeof this.component.player.fbFirstName&&"undefined"!==typeof FB)FB.api("/me",function(a){b.component.player.fbUserName=""+a.name;b.component.player.fbFirstName=""+a.first_name;b.component.player.fbLastName=""+a.last_name;"undefined"==typeof b.component.player.fbFirstName&&("undefined"!=typeof b.component.player.fbLastName?b.component.player.fbFirstName=
b.component.player.fbLastName:"undefined"!=typeof b.fbUserName&&(b.component.player.fbFirstName=b.component.player.fbUserName));"undefined"==typeof b.component.player.fbFirstName&&(b.component.player.fbFirstName="");b.performShare()}),this.component.player.fbFirstName="I am";else{if("undefined"==typeof this.component.player.fbFirstName||"undefined"==this.component.player.fbFirstName)this.component.player.fbFirstName="I am";var d=b.component.properties.shareTitle,c=a.properties.name,d=d.replace(/{resultName}/g,
c),e=b.component.properties.shareName,e=e.replace(/{resultName}/g,c),f=b.component.properties.shareDescription;if(f){var g=this.getResultProperty("description",a);g&&(f=f.replace(/{resultDescription}/g,g))}f=f.replace(/{resultName}/g,c);e=e.replace(/{userName}/g,this.component.player.fbUserName);d=d.replace(/{userName}/g,this.component.player.fbUserName);f=f.replace(/{userName}/g,this.component.player.fbUserName);e=e.replace(/{firstName}/g,this.component.player.fbFirstName);d=d.replace(/{firstName}/g,
this.component.player.fbFirstName);f=f.replace(/{firstName}/g,this.component.player.fbFirstName);e=e.replace(/{lastName}/g,this.component.player.fbLastName);d=d.replace(/{lastName}/g,this.component.player.fbLastName);f=f.replace(/{lastName}/g,this.component.player.fbLastName);d=this.replaceResultFields(d,a);e=this.replaceResultFields(e,a);f=this.replaceResultFields(f,a);c="";b.component.properties.shareUseImage&&(c=this.getResultProperty("imgUrl",a),"undefined"!==typeof c&&(0>c.indexOf("//")&&Zef._installLocation)&&
(c=Zef._installLocation+c),"undefined"!==typeof c&&0==c.indexOf("//")&&(c="https:"+c));d={method:"feed",message:d,name:e,caption:d,description:f,link:b.component.player.properties.url,picture:c,ref:"compare"};b=this;"undefined"!==typeof FB&&FB.ui(d,function(c){c&&c.post_id&&b.component.properties.ogaction&&FB.api("/me/"+b.component.properties.ogaction+"?"+b.component.properties.ogobject+"="+b.getResultProperty(b.component.properties.ogoid,a),"post",function(){})})}}};
Zef.FBCompareVisual.prototype.replaceFields=function(a){if(!this.component.properties.resultName){var b=this.component.player.getBestResult();b&&(this.component.properties.resultName=this.getResultProperty("name",b),this.component.properties.resultDescription=this.getResultProperty("description",b),this.component.properties.resultLink=this.getResultProperty("link",b),"undefined"===typeof this.component.properties.resultLink&&(this.component.properties.resultLink=""))}return Zef.Visual.prototype.replaceFields.call(this,
a)};Zef.FBCompareVisual.prototype.sendRequestsToFbIds=function(a,b,d,c,e,f){var g=null;if(g=f?f:this.component.player.getBestResult())b=b.replace(/{resultName}/g,g.properties.name),d=d.replace(/{resultName}/g,g.properties.name),b=this.replaceResultFields(b,g),d=this.replaceResultFields(d,g);FB.ui({method:"apprequests",to:a,title:b,message:d},function(){});c&&(this.component.hide(),this.component.player.showComponent(c),e&&e())};
Zef.FBCompareVisual.prototype.createFBFriendDiv=function(a){var b=document.createElement("div");b.setAttribute("class",this.classStart+"Friend");var d=document.createElement("img"),c=this.component.getFriendResult(a.id),e=!1,f=null;if(c&&null!=c){var g="imgUrl";this.component.properties.resultImage&&(g=this.component.properties.resultImage);if(c=this.component.player.getResult(c)){var e=this.getFromResult(g,c),g=this.component.getFriendResult(a.id),h=this.component.getMyGuess(a.id);this.component.properties.sameResultImage&&
g==h&&(e=this.getFromResult(this.component.properties.sameResultImage,c));if("undefined"==typeof e||null==e||""==e||"undefined"==e)e=c.imgUrl;d.setAttribute("src",e);d.setAttribute("style","display: block; background-image: url(https://graph.facebook.com/"+a.id+"/picture);");e=!0;c.name&&(f=document.createElement("div"),f.setAttribute("class","zg_fbCompareFriendTitle"),f.innerHTML=c.name)}}!1==e&&d.setAttribute("src","https://graph.facebook.com/"+a.id+"/picture");b.appendChild(d);d=document.createElement("div");
d.innerHTML=a.name;b.appendChild(d);null!=f&&b.appendChild(f);this.registerFriendClick(b,a);return b};
Zef.FBCompareVisual.prototype.getResultProperty=function(a,b){var d="";if(a&&b.properties[a])d=b.properties[a];else if(a)for(var c in b.properties.customProperties)"function"!=typeof b.properties.customProperties[c]&&b.properties.customProperties[c].name==a&&(d=b.properties.customProperties[c].value);if(""==d)if(a&&b.properties[a.toLowerCase()])d=b.properties[a.toLowerCase()];else if(a)for(c in b.properties.customProperties)"function"!=typeof b.properties.customProperties[c]&&b.properties.customProperties[c].name.toLowerCase()==
a.toLowerCase()&&(d=b.properties.customProperties[c].value);return d};Zef.FBCompareVisual.prototype.registerFriendClick=function(a,b){var d=this;zefJQuery(a).find("img").bind("mouseover",function(c){d.startMouseoverPopupTimer(a,b,c)});zefJQuery(a).find("div").first().bind("mouseover",function(c){d.startMouseoverPopupTimer(a,b,c)});zefJQuery(a).bind("mouseout",function(a){d.hideMouseoverPopup(b,a)})};
Zef.FBCompareVisual.prototype.startMouseoverPopupTimer=function(a,b,d){this.mouseOverTimer&&window.clearTimeout(this.mouseOverTimer);var c=this;this.mouseOverTimer=setTimeout(function(){c.showMouseoverPopup(a,b,d)},350)};
Zef.FBCompareVisual.prototype.showMouseoverPopup=function(a,b){this.mouseOverTimer&&(window.clearTimeout(this.mouseOverTimer),this.mouseOverTimer=null);if(null==this.mouseoverPopup){var d=this,c=this.component.getFriendResult(b.id),e=this.component.player.getResult(c);if(e){c=e.imgUrl;if(this.component.properties.mouseoverImage)if(e[this.component.properties.mouseoverImage])c=e[this.component.properties.mouseoverImage];else for(var f in e.customProperties)"function"!=typeof e.customProperties[f]&&
e.customProperties[f].name==this.component.properties.mouseoverImage&&(c=e.customProperties[f].value);var g="";if(this.component.properties.mouseoverDescription)if(e[this.component.properties.mouseoverDescription])g=e[this.component.properties.mouseoverDescription];else for(f in e.customProperties)"function"!=typeof e.customProperties[f]&&e.customProperties[f].name==this.component.properties.mouseoverDescription&&(g=e.customProperties[f].value);f="zg_fbCompareMouseoverPopup zg_fbCompareMouseoverPopup"+
this.getComponentId();this.mouseoverPopup=zefJQuery('<div class="'+f+'"><div class="mouseoverPopupResultName">'+e.name+'</div><div class="mouseoverPopupResultImage"><img class="mouseoverPopupImage" src="'+c+'" alt="'+e.name+'"></img></div><div class="mouseoverPopupResultDescription">'+g+'</div><div class="mouseoverPopupLink">'+this.component.properties.mouseoverLink+"</div></div>");zefJQuery(this.mouseoverPopup).bind("mouseout",function(a){d.hideMouseoverPopup(b,a)});zefJQuery(this.mouseoverPopup).bind("click",
function(a){d.hideMouseoverPopup(b,a)});zefJQuery("#player").append(this.mouseoverPopup);zefJQuery(".mouseoverPopupLink").bind("click",function(a){d.mouseoverLinkClicked(e);a.stopPropagation()});c=zefJQuery(a).offset().left+2;c+this.mouseoverPopup.width()>zefJQuery(document).width()&&(c=zefJQuery(document).width()-this.mouseoverPopup.width());this.mouseoverPopup.css("left",c);c=zefJQuery(a).offset().top+2;c+this.mouseoverPopup.height()>zefJQuery(window).height()&&(c=zefJQuery(window).height()-this.mouseoverPopup.height());
this.mouseoverPopup.css("top",c);this.mouseoverPopup.fadeIn("500")}}};Zef.FBCompareVisual.prototype.mouseoverLinkClicked=function(a){if(this.component.properties.mouseoverShowComponent){var b=this.component.player.getComponent(this.component.properties.mouseoverShowComponent);b&&(b.setResult(a),this.component.player.showComponent(this.component.properties.mouseoverShowComponent))}};
Zef.FBCompareVisual.prototype.hideMouseoverPopup=function(a,b){this.mouseOverTimer&&(window.clearTimeout(this.mouseOverTimer),this.mouseOverTimer=null);if(null!=this.mouseoverPopup){var d=zefJQuery(b.relatedTarget);if(!d.hasClass("zg_fbCompareMouseoverPopup")&&!d.hasClass("mouseoverPopupResultName")&&!d.hasClass("mouseoverPopupResultImage")&&!d.hasClass("mouseoverPopupImage")&&!d.hasClass("mouseoverPopupLink")&&!d.hasClass("mouseoverPopupResultDescription")){var d=b.relatedTarget?b.relatedTarget:
b.fromElement,c=b.target?b.target:b.toElement;if(!d||!c||!(jQuery(d).parent().get(0)==jQuery(c).parent().get(0)||jQuery(d).get(0)==jQuery(c).parent().get(0)||jQuery(d).parent().get(0)==jQuery(c).get(0)))zefJQuery(this.mouseoverPopup).remove(),this.mouseoverPopup=null}}};
Zef.FBCompareVisual.prototype.toggleFriendSelection=function(a,b){var d=-1,c;for(c in this.selectedFBFriends)if("function"!=typeof this.selectedFBFriends[c]&&this.selectedFBFriends[c]==b){d=c;break}0>d?(this.selectedFBFriends.push(b),zefJQuery(a).addClass(this.classStart+"FriendSelected")):(this.selectedFBFriends.splice(d,1),zefJQuery(a).removeClass(this.classStart+"FriendSelected"))};
Zef.FBCompareVisual.prototype.drawFriendList=function(a){var b=document.createElement("table");b.setAttribute("class",this.classStart+"Friends");var d=0;this.selectedFBFriends=[];a.sort(this.sortByName);for(var c in a)if("function"!=typeof a[c]){if(0==d%2){var e=document.createElement("tr");b.appendChild(e)}var d=d+1,f=document.createElement("td");f.appendChild(this.createFBFriendDiv(a[c]));e.appendChild(f)}zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendList").append(jQuery(b));
if(this.component.properties.seeAll2){a=document.createElement("div");a.setAttribute("class",this.classStart+"ResultsSeeAll");a.innerHTML=this.component.properties.seeAll2;zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendList").after(jQuery(a));var g=this;zefJQuery(a).bind("click",function(){g.component.player.showComponent(g.component.properties.seeAllComponent)})}};
Zef.FBCompareVisual.prototype.createGuessedFriendDiv=function(a,b,d){var c=document.createElement("div");c.setAttribute("class",this.classStart+"GuessedFriend");var e=document.createElement("img");if(a){e.setAttribute("src","https://graph.facebook.com/"+b.f+"/picture");c.appendChild(e);var f=document.createElement("div");FB.api({method:"fql.query",query:"SELECT name, pic_square FROM user WHERE uid = "+b.f},function(a){f.innerHTML=a[0].name});c.appendChild(f);var g=this;this.component.properties.friendBragButton?
d.id!=b.r&&(d=document.createElement("div"),d.setAttribute("class",this.classStart+"FriendBrag"),d.innerHTML=this.component.properties.friendBragButton,zefJQuery(d).bind("click",function(){g.bragFriend(a,b.f)}),c.appendChild(d)):this.registerGuessedFriendClick(c,a);return c}};Zef.FBCompareVisual.prototype.registerGuessedFriendClick=function(a){var b=this;zefJQuery(a).bind("click",function(){b.drawFriendGuesses()})};
Zef.FBCompareVisual.prototype.createGuessDiv=function(a,b,d){var c=document.createElement("div"),e=Math.round(100*(b/d));c.setAttribute("class",this.classStart+"Guess "+this.classStart+"Guess"+e);var f=document.createElement("img");if(e=this.component.player.getResult(a))f.setAttribute("src",e.imgUrl),c.appendChild(f),f=document.createElement("div"),f.setAttribute("class",this.classStart+"GuessName"),f.innerHTML=e.name,c.appendChild(f),this.component.properties.barLength&&(f=document.createElement("div"),
f.setAttribute("class",this.classStart+"GuessBar"),b="width: "+Math.round(b/d*this.component.properties.barLength)+"px; ",this.component.properties.extraSyle&&(b+=getFromResult(this.component.properties.extraSyle,e)),f.setAttribute("style",b),c.appendChild(f)),this.registerGuessClick(c,a);return c};Zef.FBCompareVisual.prototype.registerGuessClick=function(a,b){var d=this;zefJQuery(a).bind("click",function(){d.drawGuessesForResult(b)})};
Zef.FBCompareVisual.prototype.getFromResult=function(a,b){var d="";if(a&&b[a])d=b[a];else if(a)for(var c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name==a&&(d=b.customProperties[c].value);if(""==d)if(a&&b[a.toLowerCase()])d=b[a.toLowerCase()];else if(a)for(c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name.toLowerCase()==a.toLowerCase()&&(d=b.customProperties[c].value);return d};
Zef.FBCompareVisual.prototype.replaceResultFields=function(a,b,d){var c=null;b.properties&&b.properties.customProperties?c=b.properties.customProperties:b.customProperties&&(c=b.customProperties);for(var e in c)"function"!=typeof c[e]&&(b=c[e],a=a.replace(d?RegExp("{"+d+"."+b.name+"}","g"):RegExp("{"+b.name+"}","g"),b.value));return a};
Zef.FBCompareVisual.prototype.bragFriend=function(a,b){var d=this.component.player.getBestResult(),c=this;d&&(a&&this.component.properties.bragText)&&FB.api("/me",function(e){var f=c.component.properties.bragText,f=f.replace(/{userName}/g,e.name),f=f.replace(/{resultName}/g,d.properties.name),f=f.replace(/{guessedResultName}/g,a.name),f=c.replaceResultFields(f,a,"guessed"),g=f=c.replaceResultFields(f,d,"my");c.component.properties.friendBragDescription&&(g=c.getResultProperty(c.component.properties.friendBragDescription,
d),g=g.replace(/{userName}/g,e.name),g=g.replace(/{resultName}/g,d.properties.name),g=g.replace(/{guessedResultName}/g,a.name),g=c.replaceResultFields(g,a,"guessed"),g=c.replaceResultFields(g,d,"my"));e=d.properties.imgUrl;"undefined"!==typeof e&&(0>e.indexOf("//")&&Zef._installLocation)&&(e=Zef._installLocation+e);e&&"//"==e.substring(0,2)&&(e="https:"+e);FB.ui({method:"send",to:b,link:c.component.player.properties.url,description:g,picture:e,name:f})})};
Zef.FBCompareVisual.prototype.drawGuessesForResult=function(a){var b=this.component.player.getResult(a),d=this.component.player.getBestResult();if(b){var c=this,e=[],f;for(f in this.component.player.fbFriendGuesses){var g=this.component.player.fbFriendGuesses[f];"function"!=typeof g&&g.r==a&&e[g]!==g&&e.push(g)}f=document.createElement("div");f.setAttribute("class",this.classStart+"GuessResult");g=document.createElement("div");g.setAttribute("class",this.classStart+"GuessResultName");g.innerHTML=
b.name;f.appendChild(g);g=document.createElement("div");g.setAttribute("class",this.classStart+"GuessResultImage");var h=b.imgUrl;this.component.properties.guessesImage&&(h=this.getFromResult(this.component.properties.guessesImage,b));g.innerHTML='<img src="'+h+'" alt="'+b.name+'"></img>';f.appendChild(g);g=document.createElement("div");g.setAttribute("class",this.classStart+"GuessResultDescription");h="description";this.component.properties.guessesDescription&&(h=this.component.properties.guessesDescription);
g.innerHTML=this.getFromResult(h,b);f.appendChild(g);g=document.createElement("div");g.setAttribute("class",this.classStart+"GuessedFriends");for(var j in e)"function"!=typeof e[j]&&(h=this.createGuessedFriendDiv(b,e[j],d),g.appendChild(h));j=document.createElement("div");j.setAttribute("class",this.classStart+"GuessesButtons");this.component.properties.showBrag&&(this.component.properties.bragButton&&a!=d.id)&&(a=document.createElement("div"),a.setAttribute("class",this.classStart+"Brag"),a.innerHTML=
this.component.properties.bragButton,zefJQuery(a).bind("click",function(){c.brag(b,e)}),j.appendChild(a));this.component.properties.skipButton&&(a=document.createElement("div"),a.setAttribute("class",this.classStart+"BragSkip"),a.innerHTML=this.component.properties.skipButton,zefJQuery(a).bind("click",function(){c.drawFriendGuesses()}),j.appendChild(a));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").empty();a=document.createElement("div");a.setAttribute("class",
this.classStart+"GuessesTitle");this.component.properties.guessesTitle&&(a.innerHTML=this.component.properties.guessesTitle);zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(jQuery(a));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(jQuery(f));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").addClass(this.classStart+"GuessesForResult");zefJQuery("."+this.classStart+
this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(jQuery(g));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(j)}};
Zef.FBCompareVisual.prototype.brag=function(a,b){var d=this.component.player.getBestResult(),c=this;d&&(a&&this.component.properties.bragText)&&FB.api("/me",function(e){var f=c.component.properties.bragText,f=f.replace(/{userName}/g,e.name),f=f.replace(/{resultName}/g,d.properties.name),f=f.replace(/{guessedResultName}/g,a.name);e=[];for(var g in b)"function"!=typeof b[g]&&e.push(b[g].f);FB.ui({method:"apprequests",filters:["app_users"],message:f,title:f,to:e},function(){});c.drawFriendGuesses()})};
Zef.FBCompareVisual.prototype.drawFriendGuesses=function(){var a=this;if("undefined"==typeof this.component.player.fbFriendGuesses||null==this.component.player.fbFriendGuesses)this.component.loadFbFriendGuesses(function(){a.drawFriendGuesses()});else if("undefined"==typeof this.component.player.myGuesses||null==this.component.player.myGuesses)this.component.loadMyGuesses(function(){a.drawFriendGuesses()});else{var b=this.component.player.getBestResult(),d={},c=0,e;for(e in this.component.player.fbFriendGuesses){var f=
this.component.player.fbFriendGuesses[e];"function"!=typeof f&&("undefined"==typeof d[f.r]&&(d[f.r]=0),d[f.r]+=1,c+=1)}e=[];for(var g in d)"function"!=typeof d[g]&&e.push(g);e.sort(function(a,b){return d[b]-d[a]});g=document.createElement("div");g.setAttribute("class",this.classStart+"Guesses");for(var h in e)"function"!=typeof e[h]&&(f=e[h],f!=b&&g.appendChild(this.createGuessDiv(f,d[f],c)));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").empty();zefJQuery("."+
this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").removeClass(this.classStart+"GuessesForResult");b=document.createElement("div");b.setAttribute("class",this.classStart+"GuessesTitle");this.component.properties.guessesTitleResults&&(b.innerHTML=this.component.properties.guessesTitleResults);0==c&&this.component.properties.noBragText&&(c=document.createElement("div"),c.setAttribute("class","zg_fbCompareFriendsGuessesNoResults"),c.innerHTML=this.component.properties.noBragText,
g.appendChild(c));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(jQuery(b));zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"FriendsGuesses").append(jQuery(g))}};Zef.FBCompareVisual.prototype.sortByName=function(a,b){var d=a.name.toLowerCase(),c=b.name.toLowerCase();return d<c?-1:d>c?1:0};
Zef.FBChallengeVisual=function(){this.containerClassName="player";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.classStart="zg_fbChallenge"};Zef.FBChallengeVisual.prototype=new Zef.FBCompareVisual;
Zef.FBChallengeVisual.prototype.registerEvents=function(){var a=this,b=this.component.player.getBestResult();if(b){var d=document.createElement("img");d.setAttribute("src",b.properties.imgUrl);zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeResultImage").append(jQuery(d));this.component.properties.resultExtraLink&&(d=this.getResultProperty(this.component.properties.resultExtraLink,b))&&zefJQuery("."+this.classStart+this.getComponentId()+" ."+this.classStart+"ResultExtraLink").html(d)}"undefined"!==
typeof FB&&(this.component.properties.shareButton&&zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeShareButton").bind("click",function(){a.performShare()}),FB.api("/me",function(b){a.myid=b.id;FB.api("/me/friends",function(b){var c=[],d;for(d in b.data)"function"!=typeof b.data[d]&&c.push(b.data[d]);a.drawFriendList(c);a.drawFriendGuesses()})}),zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeFriendListChallenge").bind("click",function(){a.performChallenge()}),
zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeFriendListSkip").bind("click",function(){a.component.properties.skipToComponent&&(a.component.hide(),a.component.player.showComponent(a.component.properties.skipToComponent))}));var c=this.component.getResult();c&&(c.id!=b.id?(b=this.component.properties.otherResultTitle,"undefined"==typeof b&&(b=""),b=b.replace(/{resultName}/g,this.getResultProperty("name",c)),b=this.replaceResultFields(b,c),d="",this.component.properties.otherResultImage&&
(d='<img src="'+this.getResultProperty(this.component.properties.otherResultImage,c)+'" alt="'+this.getResultProperty("name",c)+'"></img>'),zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeTitle").html('<div class="zg_fbChallengeFurtherText">'+b+'</div><div class="zg_fbChallengeFurtherImage">'+d+"</div>")):(b=this.component.properties.title,"undefined"==typeof b&&(b=""),b=b.replace(/{resultName}/g,this.getResultProperty("name",c)),b=this.replaceResultFields(b,c),zefJQuery(".zg_fbChallenge"+
this.getComponentId()+" .zg_fbChallengeTitle").html(b)))};
Zef.FBChallengeVisual.prototype.performShare=function(){var a=this.component.player.getBestResult();if(!("undefined"===typeof a||null==a)){var b=this;if("undefined"==typeof this.component.player.fbFirstName&&"undefined"!==typeof FB)FB.api("/me",function(a){b.component.player.fbUserName=""+a.name;b.component.player.fbFirstName=""+a.first_name;b.component.player.fbLastName=""+a.last_name;"undefined"==typeof b.component.player.fbFirstName&&("undefined"!=typeof b.component.player.fbLastName?b.component.player.fbFirstName=
b.component.player.fbLastName:"undefined"!=typeof b.fbUserName&&(b.component.player.fbFirstName=b.component.player.fbUserName));"undefined"==typeof b.component.player.fbFirstName&&(b.component.player.fbFirstName="");b.performShare()}),this.component.player.fbFirstName="I am";else{if("undefined"==typeof this.component.player.fbFirstName||"undefined"==this.component.player.fbFirstName)this.component.player.fbFirstName="I am";var d=b.component.properties.shareTitle,c=a.properties.name,d=d.replace(/{resultName}/g,
c),e=b.component.properties.shareName,e=e.replace(/{resultName}/g,c),f=b.component.properties.shareDescription;if(f){var g=this.getResultProperty("description",a);g&&(f=f.replace(/{resultDescription}/g,g))}f=f.replace(/{resultName}/g,c);e=e.replace(/{userName}/g,this.component.player.fbUserName);d=d.replace(/{userName}/g,this.component.player.fbUserName);f=f.replace(/{userName}/g,this.component.player.fbUserName);e=e.replace(/{firstName}/g,this.component.player.fbFirstName);d=d.replace(/{firstName}/g,
this.component.player.fbFirstName);f=f.replace(/{firstName}/g,this.component.player.fbFirstName);e=e.replace(/{lastName}/g,this.component.player.fbLastName);d=d.replace(/{lastName}/g,this.component.player.fbLastName);f=f.replace(/{lastName}/g,this.component.player.fbLastName);d=this.replaceResultFields(d,a);e=this.replaceResultFields(e,a);f=this.replaceResultFields(f,a);c="";b.component.properties.shareUseImage&&(c=this.getResultProperty("imgUrl",a),"undefined"!==typeof c&&(0>c.indexOf("//")&&Zef._installLocation)&&
(c=Zef._installLocation+c),"undefined"!==typeof c&&0==c.indexOf("//")&&(c="https:"+c));d={method:"feed",message:d,name:e,caption:d,description:f,link:b.component.player.properties.url,picture:c,ref:"challenge"};b=this;"undefined"!==typeof FB&&FB.ui(d,function(c){c&&c.post_id&&b.component.properties.ogaction&&FB.api("/me/"+b.component.properties.ogaction+"?"+b.component.properties.ogobject+"="+b.getResultProperty(b.component.properties.ogoid,a),"post",function(){})})}}};
Zef.FBChallengeVisual.prototype.createFBFriendDiv=function(a){if(!0==this.component.hasAnswer(a.id)&&this.component.disableAnswered){var b=document.createElement("div");b.setAttribute("class",this.classStart+"Friend "+this.classStart+"FriendDisabled");var d=document.createElement("img"),c=this.component.getFriendResult(a.id),e=!1,f=null;if(c&&null!=c){var g="imgUrl";this.component.properties.resultImage&&(g=this.component.properties.resultImage);if(c=this.component.player.getResult(c)){f=this.getFromResult(g,
c);e=this.component.getFriendResult(a.id);g=this.component.getMyGuess(a.id);this.component.properties.sameResultImage&&e==g&&(f=this.getFromResult(this.component.properties.sameResultImage,c));if("undefined"==typeof f||null==f||""==f||"undefined"==f)f=c.imgUrl;d.setAttribute("src",f);d.setAttribute("style","display: block; background-image: url(https://graph.facebook.com/"+a.id+"/picture);");e=!0;f=document.createElement("div");f.setAttribute("class","zg_fbChallengeFriendTitle");f.innerHTML=c.name}}!1==
e&&d.setAttribute("src","https://graph.facebook.com/"+a.id+"/picture");b.appendChild(d);d=document.createElement("div");d.innerHTML=a.name;b.appendChild(d);null!=f&&b.appendChild(f)}else if(b=document.createElement("div"),b.setAttribute("class",this.classStart+"Friend"),d=document.createElement("img"),this.component.getFriendResult(a.id),d.setAttribute("src","https://graph.facebook.com/"+a.id+"/picture"),b.appendChild(d),d=document.createElement("div"),d.innerHTML=a.name,b.appendChild(d),this.registerFriendClick(b,
a),this.component.disableAnswered&&(g=this.component.getMyGuess(a.id)))if(c=this.component.player.getResult(g))f=document.createElement("div"),f.setAttribute("class","zg_fbChallengeFriendTitle"),f.innerHTML=c.name+"?",b.appendChild(f);return b};
Zef.FBChallengeVisual.prototype.replaceFields=function(a){var b=this.component.getResult(),d=this.component.player.getBestResult();if(b)if(this.component.properties.resultName=this.getResultProperty("name",d),this.component.properties.resultDescription=this.getResultProperty("description",d),this.component.properties.resultLink=this.getResultProperty("link",d),"undefined"===typeof this.component.properties.resultLink&&(this.component.properties.resultLink=""),b.id!=d.id){d=this.component.properties.otherResultTitle;
"undefined"==typeof d&&(d="");var d=d.replace(/{resultName}/g,this.getResultProperty("name",b)),d=this.replaceResultFields(d,b),c="";this.component.properties.otherResultImage&&(c='<img src="'+this.getResultProperty(this.component.properties.otherResultImage,b)+'" alt="'+this.getResultProperty("name",b)+'"></img>');zefJQuery(".zg_fbChallenge"+this.getComponentId()+" .zg_fbChallengeTitle").html('<div class="zg_fbChallengeFurtherText">'+d+'</div><div class="zg_fbChallengeFurtherImage">'+c+"</div>")}else zefJQuery(".zg_fbChallenge"+
this.getComponentId()+" .zg_fbChallengeTitle").html("{title}");return Zef.Visual.prototype.replaceFields.call(this,a)};Zef.FBChallengeVisual.prototype.registerFriendClick=function(a,b){var d=this;zefJQuery(a).bind("click",function(){d.toggleFriendSelection(a,b)})};
Zef.FBChallengeVisual.prototype.performChallenge=function(){if(this.selectedFBFriends&&0<this.selectedFBFriends.length){for(var a=this.component.getResult(),b=[],d=this.selectedFBFriends.length/50+1,c=0;c<d;c++){for(var e=50*c;e<this.selectedFBFriends.length&&e<50*c+50;e++)"function"!=typeof this.selectedFBFriends[e]&&(b.push(this.selectedFBFriends[e].id),this.component.addMyGuess({f:this.selectedFBFriends[e].id,r:a.id}));Zef.queryDataServer("challenge",{me:a.id,friends:b},function(){})}var f=this;
FB.api("/fql",{q:"SELECT uid,is_app_user FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND is_app_user = 1"},function(a){for(var c=0;c<a.data.length;c++)0<=b.indexOf(a.data[c].id)&&b.splice(b.indexOf(a.data[c].id),1);f.sendRequests(b)})}};
Zef.FBChallengeVisual.prototype.sendRequests=function(a){var b=this;FB.api("/me",function(d){var c=b.component.properties.challengeText,c=c.replace(/{userName}/g,d.name),e=b.component.properties.challengeTitle,e=e.replace(/{userName}/g,d.name);b.sendRequestsToFbIds(a,e,c,b.component.properties.nextComponent,function(){if(b.component.properties.doneText){var a=b.component.getResult(),c=b.component.player.getBestResult();if(a.id!=c.id||b.component.properties.doneAlways){var d=document.createElement("div");
d.setAttribute("class","zg_fbChallengeDone_"+b.getComponentId());a=document.createElement("div");a.setAttribute("class","zg_fbChallengeDoneText");a.innerHTML=b.component.properties.doneText;d.appendChild(a);a=document.createElement("div");a.setAttribute("class","zg_fbChallengeDoneButton");a.innerHTML=b.component.properties.doneButton;d.appendChild(a);var e=document.createElement("div");e.setAttribute("class","zg_fbChallengeDoneBG");zefJQuery("#player").append(zefJQuery(e));zefJQuery("#player").append(zefJQuery(d));
zefJQuery(a).bind("click",function(){zefJQuery(e).remove();zefJQuery(d).remove()})}}},b.component.getResult())})};Zef.GuessRewardsVisual=function(){this.containerClassName="player";this.skipStyle=this.skipOrder=this.useContainerClassName=!0};Zef.GuessRewardsVisual.prototype=new Zef.Visual;
Zef.GuessRewardsVisual.prototype.registerEvents=function(){var a=this;if(this.component.noResults){if(this.component.properties.noGuessesOnlyFirstTime&&0==this.component.player.answeredQuestionCount()){this.component.hide();this.component.player.showComponent(this.component.properties.skipToComponent);return}var b=document.createElement("div");b.setAttribute("class","zg_rewardsplayer_NoGuessRewards_"+this.getComponentId());var d=document.createElement("div");d.setAttribute("class","zg_norewardsText");
d.innerHTML=this.component.properties.noGuesses;b.appendChild(d);d=document.createElement("div");d.setAttribute("class","zg_norewardsAllResults");d.innerHTML=this.component.properties.allResultsButton;b.appendChild(d);var c=document.createElement("div");c.setAttribute("class","zg_norewardsHide");b.appendChild(c);zefJQuery(".zg_rewards"+this.getComponentId()).replaceWith(zefJQuery(b));zefJQuery(d).bind("click",function(){a.component.hide();a.component.player.showComponent(a.component.properties.skipToComponent);
a.component.player.showComponent(a.component.properties.allResultsComponent)});zefJQuery(c).bind("click",function(){a.component.hide();a.component.player.showComponent(a.component.properties.skipToComponent)})}else this.addCorrectGuesses(),Zef.Visual.prototype.registerEvents.call(this),zefJQuery(".zg_rewards"+this.getComponentId()+" .zg_rewardsFriendListClaim").bind("click",function(){a.claimRewards()}),zefJQuery(".zg_rewards"+this.getComponentId()+" .zg_rewardsFriendListSkip").bind("click",function(){a.component.properties.skipToComponent&&
(a.component.hide(),a.component.player.showComponent(a.component.properties.skipToComponent))});zefJQuery("#player").append('<div class="zg_rewardsBG"></div>')};Zef.GuessRewardsVisual.prototype.removeUiElement=function(){zefJQuery(".zg_rewardsBG").remove();Zef.Visual.prototype.removeUiElement.call(this)};
Zef.GuessRewardsVisual.prototype.claimRewards=function(){if(this.component.correctGuesses){for(var a=[],b=0;b<this.component.correctGuesses.length;b++)"function"!=typeof this.component.correctGuesses[b]&&a.push(this.component.correctGuesses[b].f);Zef.queryDataServer("claim",{friends:a},function(){})}this.component.properties.nextComponent&&(this.component.hide(),this.component.player.showComponent(this.component.properties.nextComponent))};
Zef.GuessRewardsVisual.prototype.createCorrectGuessElement=function(a,b){var d=document.createElement("div");d.setAttribute("class","zg_rewardCorrectGuess");var c=this;FB.api({method:"fql.query",query:"SELECT name, pic_square FROM user WHERE uid="+a},function(a){var f=document.createElement("img");f.setAttribute("style","display: block; background-image: url("+a[0].pic_square+");");var g=c.component.player.getResult(b);if(g){var h="imgUrl";c.component.properties.image&&(h=c.component.properties.image);
g=c.getFromResult(h,g);f.setAttribute("src",g)}else f.setAttribute("src",a[0].pic_square);d.appendChild(f);f=document.createElement("div");f.innerHTML=a[0].name;d.appendChild(f)});return d};
Zef.GuessRewardsVisual.prototype.getFromResult=function(a,b){var d="";if(a&&b[a])d=b[a];else if(a)for(var c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name==a&&(d=b.customProperties[c].value);if(""==d)if(a&&b[a.toLowerCase()])d=b[a.toLowerCase()];else if(a)for(c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name.toLowerCase()==a.toLowerCase()&&(d=b.customProperties[c].value);return d};
Zef.GuessRewardsVisual.prototype.addCorrectGuesses=function(){var a=document.createElement("table");a.setAttribute("class","zg_rewardCorrectGuesses");var b=0;if(this.component.correctGuesses)for(var d in this.component.correctGuesses){var c=this.component.correctGuesses[d];if("function"!=typeof c[d]){if(0==b%2){var e=document.createElement("tr");a.appendChild(e)}var b=b+1,f=document.createElement("td");f.appendChild(this.createCorrectGuessElement(c.f,c.r));e.appendChild(f)}}zefJQuery(".zg_rewards"+
this.getComponentId()+" .zg_rewardsFriendList").append(jQuery(a))};Zef.ResultInfoVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0;this.result=null};Zef.ResultInfoVisual.prototype=new Zef.Visual;
Zef.ResultInfoVisual.prototype.replaceFields=function(a){this.component.result&&this.component.properties.title&&(this.component.properties.title=this.component.properties.title.replace(/{resultName}/g,this.component.result.name));zefJQuery("#player").append('<div class="zg_resultInfoBG"></div>');return Zef.Visual.prototype.replaceFields.call(this,a)};Zef.ResultInfoVisual.prototype.removeUiElement=function(){zefJQuery(".zg_resultInfoBG").remove();Zef.Visual.prototype.removeUiElement.call(this)};
Zef.ResultInfoVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoHide").bind("click",function(){a.component.hide()});zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoChallenge").bind("click",function(){a.goToChallenge()});if(this.component.result){var b=this.component.result.name;zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoResultName").html(b);var d=this.component.result.description;this.component.properties.descriptionComponent&&
""!=this.getResultProperty(this.component.properties.descriptionComponent,this.component.result)&&(d=this.getResultProperty(this.component.properties.descriptionComponent,this.component.result));zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoResultDescription").html(d);d=this.component.result.imgUrl;this.component.properties.imageComponent&&""!=this.getResultProperty(this.component.properties.imageComponent,this.component.result)&&(d=this.getResultProperty(this.component.properties.imageComponent,
this.component.result));zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoResultImage").html('<img src="'+d+'" alt="'+b+'"></img>');this.component.properties.linkComponent&&""!=this.getResultProperty(this.component.properties.linkComponent,this.component.result)&&zefJQuery(".zg_resultInfo"+this.getComponentId()+" .zg_resultInfoResultLinkButton").html(this.getResultProperty(this.component.properties.linkComponent,this.component.result));zefJQuery(".zg_resultInfo"+this.getComponentId()+
" .zg_resultInfoResultLink").bind("click",function(){a.showAll()})}};Zef.ResultInfoVisual.prototype.goToChallenge=function(){var a=this.component.player.getComponent(this.component.properties.challengeComponent);if(a){var b=new Zef.TargetResult;b.id=this.component.result.answererId;b.properties=this.component.result;a.setResult(b)}this.component.player.showComponent(this.component.properties.challengeComponent)};
Zef.ResultInfoVisual.prototype.getResultProperty=function(a,b){var d="";if(a&&b[a])d=b[a];else if(a)for(var c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name==a&&(d=b.customProperties[c].value);if(""==d)if(a&&b[a.toLowerCase()])d=b[a.toLowerCase()];else if(a)for(c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name.toLowerCase()==a.toLowerCase()&&(d=b.customProperties[c].value);return d};
Zef.ResultInfoVisual.prototype.showAll=function(){this.component.player.showComponent(this.component.properties.nextComponent);this.component.hide()};Zef.AllResultsVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0};Zef.AllResultsVisual.prototype=new Zef.Visual;
Zef.AllResultsVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_allResults"+this.getComponentId()+" .zg_allResultsHide").bind("click",function(){a.component.hide()});zefJQuery("#player").append('<div class="zg_allResultsBG"></div>');this.drawAllResults()};Zef.AllResultsVisual.prototype.removeUiElement=function(){zefJQuery(".zg_allResultsBG").remove();Zef.Visual.prototype.removeUiElement.call(this)};
Zef.AllResultsVisual.prototype.drawResult=function(a){var b=document.createElement("div");b.setAttribute("class","zg_allResultsResult");var d=document.createElement("div");d.setAttribute("class","zg_allResultsImage");var c=document.createElement("img");this.component.properties.resultImage?c.setAttribute("src",this.getResultProperty(this.component.properties.resultImage,a)):c.setAttribute("src",a.imgUrl);d.appendChild(c);b.appendChild(d);d=document.createElement("div");d.setAttribute("class","zg_allResultsName");
d.innerHTML=this.component.properties.resultName?this.getResultProperty(this.component.properties.resultName,a):a.name;b.appendChild(d);d=document.createElement("div");d.setAttribute("class","zg_allResultsDescription");this.component.properties.resultDescription&&(d.innerHTML=this.getResultProperty(this.component.properties.resultDescription,a));b.appendChild(d);zefJQuery(".zg_allResults"+this.getComponentId()+" .zg_allResultsResultList").append(zefJQuery(b));d=document.createElement("div");d.setAttribute("class",
"zg_allResultsChallenge");d.innerHTML=this.component.properties.challengeText;b.appendChild(d);var e=this;zefJQuery(d).bind("click",function(){e.performChallenge(a)})};Zef.AllResultsVisual.prototype.getResultProperty=function(a,b){var d="";if(a&&b[a])d=b[a];else if(a)for(var c in b.customProperties)"function"!=typeof b.customProperties[c]&&b.customProperties[c].name==a&&(d=b.customProperties[c].value);return d};
Zef.AllResultsVisual.prototype.performChallenge=function(a){var b=this.component.player.getComponent(this.component.properties.challengeComponent);b&&b.setResult(this.component.player.getResult(a.answererId));this.component.player.showComponent(this.component.properties.challengeComponent)};
Zef.AllResultsVisual.prototype.drawAllResults=function(){var a=this.component.player;if(a.components.get("ResultList")&&(a=a.components.get("ResultList"),a.properties&&a.properties.replies))for(var b in a.properties.replies)"function"!=typeof a.properties.replies[b]&&this.drawResult(a.properties.replies[b])};Zef.AutoFBShareVisual=function(){this.containerClassName="player";this.useContainerClassName=!1;this.skipStyle=this.skipOrder=!0};Zef.AutoFBShareVisual.prototype=new Zef.Visual;
Zef.AutoFBShareVisual.prototype.registerEvents=function(){var a=this;zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareHide").bind("click",function(){a.component.hide()});zefJQuery("#player").append('<div class="zg_autoshareBG"></div>');zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareSkipButton").bind("click",function(){a.skipShare()});zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareShareButton").bind("click",function(){a.component.hide();a.component.performShare()});
var b=this.component.player.getBestResult();if(b&&(this.component.properties.useDescription&&zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareDescription").html(b.properties.description),this.setTexts(),this.component.properties.useImage)){var d=b.properties.targetImage;"undefined"!==typeof d&&0==d.indexOf("//")&&(d="https:"+d);"undefined"!==typeof d&&""!=d&&zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareImage").html('<img src="'+d+'" alt="'+b.name+'"></img>')}this.component.properties.languages&&
this.component.properties.locales&&this.addLanguageSelector()};Zef.AutoFBShareVisual.prototype.skipShare=function(){this.component.properties.hidePlayer&&(zefJQuery(".zg_player_header").hide(),zefJQuery(".zef_item_1").hide(),zefJQuery(".zef_item_2").hide(),zefJQuery(".zef_item_3").hide(),zefJQuery(".zg_player_footer").hide());this.component.properties.nextComponent&&(this.component.hide(),this.component.player.showComponent(this.component.properties.nextComponent))};
Zef.AutoFBShareVisual.prototype.addLanguageSelector=function(){"undefined"==typeof this.component.shareLanguage&&Zef._lang&&(this.component.shareLanguage=Zef._lang);"undefined"==typeof this.component.shareLanguage&&(this.component.shareLanguage="en");var a=this.component.properties.locales.split(","),b=this.component.properties.languages.split(",");0<=a.indexOf(this.component.shareLanguage)&&zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareLanguages").html(b[a.indexOf(this.component.shareLanguage)]);
var d=this;zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareLanguages").bind("click",function(){d.showLanguageSelector(a,b,this)})};
Zef.AutoFBShareVisual.prototype.showLanguageSelector=function(a,b){var d=document.createElement("div");d.setAttribute("class","zg_autoShareLangSelector");d=zefJQuery(d);zefJQuery(".zg_autoShare"+this.getComponentId()).append(d);for(var c in a)"function"!=typeof a[c]&&this.addLanguageToSelector(b[c],a[c],d);d.position({my:"left top",at:"left bottom",of:".zg_autoShare"+this.getComponentId()+" .zg_autoShareLanguages"})};
Zef.AutoFBShareVisual.prototype.setTexts=function(){var a=this.component.player.getBestResult(),b=this.component.properties.previewTitle;if(this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]){var d=this.component.name+"_"+this.component.properties.id+"_previewTitle";Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(b=Zef._locales[this.component.player.id][this.component.shareLanguage][d])}var c=
a.properties.name;this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]&&(d="results_"+a.id+"_name",Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(c=Zef._locales[this.component.player.id][this.component.shareLanguage][d]));var b=b.replace(/{resultName}/g,c),e=this.component.properties.name;this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&
Zef._locales[this.component.player.id][this.component.shareLanguage]&&(d=this.component.name+"_"+this.component.properties.id+"_name",Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(e=Zef._locales[this.component.player.id][this.component.shareLanguage][d]));e=e.replace(/{resultName}/g,c);c=this.component.properties.description;this.component.properties.previewDescription&&(c=this.component.properties.previewDescription);if(this.component.properties.description){var f=a.properties.description;
if(this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]){var d=this.component.name+"_"+this.component.properties.id+"_customProperties_description",g=this.component.name+"_"+this.component.properties.id+"_customProperties_Description";Zef._locales[this.component.player.id][this.component.shareLanguage][d]?f=Zef._locales[this.component.player.id][this.component.shareLanguage][d]:Zef._locales[this.component.player.id][this.component.shareLanguage][g]&&
(f=Zef._locales[this.component.player.id][this.component.shareLanguage][g])}c=c.replace(/{resultDescription}/g,f)}e=this.component.replaceResultFields(e,a);b=this.component.replaceResultFields(b,a);c=this.component.replaceResultFields(c,a);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareName").html(e);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareTitle").html(b);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareDescription").html(c)};
Zef.AutoFBShareVisual.prototype.changeTexts=function(){if(this.component.shareLanguage){var a=this.component.player.getBestResult(),b=this.component.properties.previewTitle;if(this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]){var d=this.component.name+"_"+this.component.properties.id+"_previewTitle";Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(b=Zef._locales[this.component.player.id][this.component.shareLanguage][d])}var c=
a.properties.name;this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]&&(d="results_"+a.id+"_name",Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(c=Zef._locales[this.component.player.id][this.component.shareLanguage][d]));var b=b.replace(/{resultName}/g,c),e=this.component.properties.name;this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&
Zef._locales[this.component.player.id][this.component.shareLanguage]&&(d=this.component.name+"_"+this.component.properties.id+"_name",Zef._locales[this.component.player.id][this.component.shareLanguage][d]&&(e=Zef._locales[this.component.player.id][this.component.shareLanguage][d]));e=e.replace(/{resultName}/g,c);c=this.component.properties.description;this.component.properties.previewDescription&&(c=this.component.properties.previewDescription);if(this.component.properties.description){var f=a.properties.description;
if(this.component.shareLanguage&&(Zef._locales&&Zef._locales[this.component.player.id])&&Zef._locales[this.component.player.id][this.component.shareLanguage]){var d=this.component.name+"_"+this.component.properties.id+"_customProperties_description",g=this.component.name+"_"+this.component.properties.id+"_customProperties_Description";Zef._locales[this.component.player.id][this.component.shareLanguage][d]?f=Zef._locales[this.component.player.id][this.component.shareLanguage][d]:Zef._locales[this.component.player.id][this.component.shareLanguage][g]&&
(f=Zef._locales[this.component.player.id][this.component.shareLanguage][g])}c=c.replace(/{resultDescription}/g,f)}e=this.component.replaceResultFields(e,a);b=this.component.replaceResultFields(b,a);c=this.component.replaceResultFields(c,a);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareName").html(e);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareTitle").html(b);zefJQuery(".zg_autoShare"+this.getComponentId()+" .zg_autoShareDescription").html(c)}};
Zef.AutoFBShareVisual.prototype.addLanguageToSelector=function(a,b,d){var c=document.createElement("div");c.setAttribute("class","zg_autoShareLocale");c.innerHTML=a;c=zefJQuery(c);d.append(c);var e=this;c.bind("click",function(){zefJQuery(".zg_autoShare"+e.getComponentId()+" .zg_autoShareLanguages").html(a);e.component.shareLanguage=b;e.changeTexts();d.hide();d.remove()})};
Zef.AutoFBShareVisual.prototype.replaceFields=function(a){var b=this.component.player.getBestResult();if(!("undefined"===typeof b||null==b))return this.component.properties.title&&(this.component.properties.title=this.component.properties.title.replace(/{resultName}/g,b.properties.name),this.component.properties.title=this.component.properties.title.replace(/{userName}/g,this.component.player.fbUserName),this.component.properties.title=this.component.properties.title.replace(/{firstName}/g,this.component.player.fbFirstName),
this.component.properties.title=this.component.properties.title.replace(/{lastName}/g,this.component.player.fbLastName)),this.component.properties.previewTitle&&(this.component.properties.previewTitle=this.component.properties.previewTitle.replace(/{resultName}/g,b.properties.name),this.component.properties.previewTitle=this.component.properties.previewTitle.replace(/{userName}/g,this.component.player.fbUserName),this.component.properties.previewTitle=this.component.properties.previewTitle.replace(/{firstName}/g,
this.component.player.fbFirstName),this.component.properties.previewTitle=this.component.properties.previewTitle.replace(/{lastName}/g,this.component.player.fbLastName)),Zef.Visual.prototype.replaceFields.call(this,a)};Zef.AutoFBShareVisual.prototype.removeUiElement=function(){zefJQuery(".zg_autoshareBG").remove();Zef.Visual.prototype.removeUiElement.call(this)};
Zef.LanguageSelectorVisual=function(){this.containerClassName="player";this.skipStyle=this.skipOrder=this.useContainerClassName=!0;this.data=null};Zef.LanguageSelectorVisual.prototype=new Zef.Visual;
Zef.LanguageSelectorVisual.prototype.registerEvents=function(){Zef.Visual.prototype.registerEvents.call(this);var a=this;zefJQuery(".zg_languageSelector"+this.getComponentId()+" .zg_languageSelectorOkButton").bind("click",function(){a.component.applyChange()});zefJQuery(".zg_languageSelector"+this.getComponentId()+" .zg_languageSelectorHide").bind("click",function(){a.component.hide()});zefJQuery("#player").append('<div class="zg_languageSelectorInfoBG"></div>');this.addLanguageSelector()};
Zef.LanguageSelectorVisual.prototype.addLanguageSelector=function(){"undefined"==typeof Zef._lang&&(Zef._lang="en");var a=this.component.properties.locales.split(","),b=this.component.properties.languages.split(",");0<=a.indexOf(Zef._lang)&&zefJQuery(".zg_languageSelector"+this.getComponentId()+" .zg_languageSelectorLanguages").html(b[a.indexOf(Zef._lang)]);var d=this;zefJQuery(".zg_languageSelector"+this.getComponentId()+" .zg_languageSelectorLanguages").bind("click",function(){d.showLanguageSelector(a,
b,this)})};Zef.LanguageSelectorVisual.prototype.showLanguageSelector=function(a,b){var d=document.createElement("div");d.setAttribute("class","zg_languageSelectorLangSelector");d=zefJQuery(d);zefJQuery(".zg_languageSelector"+this.getComponentId()).append(d);for(var c in a)"function"!=typeof a[c]&&this.addLanguageToSelector(b[c],a[c],d);d.position({my:"left top",at:"left bottom",of:".zg_languageSelector"+this.getComponentId()+" .zg_languageSelectorLanguages"})};
Zef.LanguageSelectorVisual.prototype.addLanguageToSelector=function(a,b,d){var c=document.createElement("div");c.setAttribute("class","zg_languageSelectorLocale");c.innerHTML=a;c=zefJQuery(c);d.append(c);var e=this;c.bind("click",function(){zefJQuery(".zg_languageSelector"+e.getComponentId()+" .zg_languageSelectorLanguages").html(a);Zef._lang=b;d.hide();d.remove()})};Zef.LanguageSelectorVisual.prototype.removeUiElement=function(){zefJQuery(".zg_languageSelectorInfoBG").remove();Zef.Visual.prototype.removeUiElement.call(this)};